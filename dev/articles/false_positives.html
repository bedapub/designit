<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Batch effects and false positives: a simulation study • designit</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Batch effects and false positives: a simulation study">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">designit</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.5.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basic_examples.html">Basic example of using designit: plate layout with two factors</a>
    </li>
    <li>
      <a href="../articles/custom_shuffle.html">Using custom shuffle schedule</a>
    </li>
    <li>
      <a href="../articles/false_positives.html">Batch effects and false positives: a simulation study</a>
    </li>
    <li>
      <a href="../articles/invivo_study_design.html">In-vivo study design</a>
    </li>
    <li>
      <a href="../articles/NCS22_talk.html">designit: a flexible engine to generate experiment layouts</a>
    </li>
    <li>
      <a href="../articles/nested_dimensions_examples.html">Nested dimension example</a>
    </li>
    <li>
      <a href="../articles/optimizer_examples.html">Optimizer examples</a>
    </li>
    <li>
      <a href="../articles/osat.html">OSAT and scoring functions</a>
    </li>
    <li>
      <a href="../articles/plate_layouts.html">Plate layouts</a>
    </li>
    <li>
      <a href="../articles/plate_scoring_examples.html">Plate scoring examples</a>
    </li>
    <li>
      <a href="../articles/shuffling_with_constraints.html">Shuffling with constraints</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/BEDApub/designit" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Batch effects and false positives: a simulation
study</h1>
                        <h4 data-toc-skip class="author">Jitao david
Zhang</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/BEDApub/designit/tree/main/vignettes/false_positives.Rmd" class="external-link"><code>vignettes/false_positives.Rmd</code></a></small>
      <div class="hidden name"><code>false_positives.Rmd</code></div>

    </div>

    
    
<p>In this document, we demonstrate the necessity of a proper experiment
design with a generative model which we use to simulate data with
“batch” effects. We show that a proper experiment design helps
experimentalists and analysts make correct inference about the quantity
of interest that is robust against randomness.</p>
<pre><code><span><span class="co">#&gt; ── <span style="font-weight: bold;">Attaching core tidyverse packages</span> ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr    </span> 1.1.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr    </span> 2.1.5</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats  </span> 1.0.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr  </span> 1.5.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2  </span> 3.5.1     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble   </span> 3.2.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">lubridate</span> 1.9.3     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr    </span> 1.3.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr    </span> 1.0.2     </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span></code></pre>
<div class="section level2">
<h2 id="a-simple-case-study-about-plate-effect-the-background">A simple case study about plate effect: the background<a class="anchor" aria-label="anchor" href="#a-simple-case-study-about-plate-effect-the-background"></a>
</h2>
<p>Assume we perform an experiment to test the effect of eleven drug
candidates under development on cell viability. To do so, we treat cells
in culture with a fixed concentration of each of the eleven candidates,
and we treat cells with DMSO (dimethyl sulfoxide) as a vehicle control,
since the drug candidates are all solved in DMSO solutions.</p>
<p>To assess the effect with regard to the variability intrinsic to the
experiment setup, we measure the effect of each drug candidate (and
DMSO) in eight different batches of cells, which are comparable to each
other.</p>
<p>In total, we have 96 samples: 11 drug candidates plus one DMSO
control, 8 samples each. The samples neatly fit into a 96-well
microtiter plate with 8 rows, and 12 columns.</p>
<p>In order to avoid batch effects and to make the operation simple, all
operations and measurements are done by the same careful operator and
performed at the same time. The operator has two possibilities:</p>
<ol style="list-style-type: decimal">
<li>She does <em>not</em> randomize the samples with regard to the plate
layout. The naive layout will put each drug candidate or control (DMSO)
in one column. For simplicity, let us assume that the cells treated with
DMSO are put in column 1, and cells treated with the eleven drug
candidates are put in columns 2 to 12.</li>
<li>She randomizes the samples with regard to the plate layout, so that
nearby samples are not necessarily of the same condition.</li>
</ol>
<p>What is the difference between the two variants? Option 2 apparently
involves more planning and labor than option 1. If manual instead of
robotic pipetting is involved, option 2 is likely error-prone. So why
bothering considering the later option?</p>
<p>Randomization pays off when unwanted variance is large enough so that
it may distort our estimate of the quantity in which we are interested
in. In our example, the unwanted variance may come from a <em>plate
effect</em>: due to variances in temperature, humidity, and evaporation
between wells in the plate, cells may respond differently to <em>even
the same treatment</em>. Such <em>plate effects</em> are difficult to
judge practically because they are not known prior to the experiment,
unless a calibration study is performed where the cells in a microtiter
plate are indeed treated with the same condition and measurements are
performed in order to quantify the plate effect. However, it is simple
to <em>simulate</em> such plate effects <em>in silico</em> with <em>a
generative model</em>, and test the effect of randomization.</p>
<p>For simplicity, we make following further assumptions:</p>
<ol style="list-style-type: decimal">
<li>The plate effect is radial, i.e. cells in wells on the edges are
more affected by than cells in wells in the middle of the plate.</li>
<li>The plate effect is positive, i.e. cells in edge wells show higher
viability than cells in the middle wells.</li>
<li>None of the tested compounds regulate cell viability significantly,
i.e. cells treated with compounds and cell treated with DMSO control
have the same expected value of viability. We simulate the effect of
DMSO and compounds by drawing random samples from a normal
distribution.</li>
<li>The true effect of compounds and the plate effect is additive,
i.e. our measurement is the sum of the true effect and the plate
effect.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2307111</span><span class="op">)</span></span>
<span></span>
<span><span class="va">conditions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DMSO"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Compound%02d"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># set up batch container</span></span>
<span><span class="va">bc</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/BatchContainer.html">BatchContainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    row <span class="op">=</span> <span class="fl">8</span>, col <span class="op">=</span> <span class="fl">12</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># assign samples with conditions and true effects</span></span>
<span>  <span class="fu"><a href="../reference/assign_in_order.html">assign_in_order</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      SampleIndex <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">96</span>,</span>
<span>      Compound <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">conditions</span>, <span class="fl">8</span><span class="op">)</span>, levels <span class="op">=</span> <span class="va">conditions</span><span class="op">)</span>,</span>
<span>      trueEffect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">96</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulating-a-study-in-which-randomization-is-not-used">Simulating a study in which randomization is not used<a class="anchor" aria-label="anchor" href="#simulating-a-study-in-which-randomization-is-not-used"></a>
</h2>
<p>First we simulate a study in which randomization is not used. In this
context, it means that the treatment (controls and compounds in columns)
and the plate effect are correlated. The following plot visualizes the
layout of the plate, the true effect, the plate effect, and the
measurement as a sum of the true effect and the plate effect.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get observations with batch effect</span></span>
<span><span class="va">get_observations</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">bc</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">bc</span><span class="op">$</span><span class="fu">get_samples</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      plateEffect <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">row</span> <span class="op">-</span> <span class="fl">4.5</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="va">col</span> <span class="op">-</span> <span class="fl">6.5</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>      measurement <span class="op">=</span> <span class="va">trueEffect</span> <span class="op">+</span> <span class="va">plateEffect</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">get_observations</span><span class="op">(</span><span class="va">bc</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div id="rtnixzevfi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rtnixzevfi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rtnixzevfi thead, #rtnixzevfi tbody, #rtnixzevfi tfoot, #rtnixzevfi tr, #rtnixzevfi td, #rtnixzevfi th {
  border-style: none;
}

#rtnixzevfi p {
  margin: 0;
  padding: 0;
}

#rtnixzevfi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rtnixzevfi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rtnixzevfi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rtnixzevfi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rtnixzevfi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rtnixzevfi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rtnixzevfi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rtnixzevfi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rtnixzevfi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rtnixzevfi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rtnixzevfi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rtnixzevfi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rtnixzevfi .gt_spanner_row {
  border-bottom-style: hidden;
}

#rtnixzevfi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rtnixzevfi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rtnixzevfi .gt_from_md > :first-child {
  margin-top: 0;
}

#rtnixzevfi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rtnixzevfi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rtnixzevfi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rtnixzevfi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rtnixzevfi .gt_row_group_first td {
  border-top-width: 2px;
}

#rtnixzevfi .gt_row_group_first th {
  border-top-width: 2px;
}

#rtnixzevfi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rtnixzevfi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rtnixzevfi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rtnixzevfi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rtnixzevfi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rtnixzevfi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rtnixzevfi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rtnixzevfi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rtnixzevfi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rtnixzevfi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rtnixzevfi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rtnixzevfi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rtnixzevfi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rtnixzevfi .gt_left {
  text-align: left;
}

#rtnixzevfi .gt_center {
  text-align: center;
}

#rtnixzevfi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rtnixzevfi .gt_font_normal {
  font-weight: normal;
}

#rtnixzevfi .gt_font_bold {
  font-weight: bold;
}

#rtnixzevfi .gt_font_italic {
  font-style: italic;
}

#rtnixzevfi .gt_super {
  font-size: 65%;
}

#rtnixzevfi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rtnixzevfi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rtnixzevfi .gt_indent_1 {
  text-indent: 5px;
}

#rtnixzevfi .gt_indent_2 {
  text-indent: 10px;
}

#rtnixzevfi .gt_indent_3 {
  text-indent: 15px;
}

#rtnixzevfi .gt_indent_4 {
  text-indent: 20px;
}

#rtnixzevfi .gt_indent_5 {
  text-indent: 25px;
}

#rtnixzevfi .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rtnixzevfi div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="row">row</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="col">col</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="SampleIndex">SampleIndex</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Compound">Compound</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="trueEffect">trueEffect</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="plateEffect">plateEffect</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="measurement">measurement</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="row" class="gt_row gt_right">1</td>
<td headers="col" class="gt_row gt_right">1</td>
<td headers="SampleIndex" class="gt_row gt_right">1</td>
<td headers="Compound" class="gt_row gt_center">DMSO</td>
<td headers="trueEffect" class="gt_row gt_right">9.530078</td>
<td headers="plateEffect" class="gt_row gt_right">3.259601</td>
<td headers="measurement" class="gt_row gt_right">12.78968</td>
</tr>
<tr>
<td headers="row" class="gt_row gt_right">1</td>
<td headers="col" class="gt_row gt_right">2</td>
<td headers="SampleIndex" class="gt_row gt_right">2</td>
<td headers="Compound" class="gt_row gt_center">Compound01</td>
<td headers="trueEffect" class="gt_row gt_right">10.946764</td>
<td headers="plateEffect" class="gt_row gt_right">2.850439</td>
<td headers="measurement" class="gt_row gt_right">13.79720</td>
</tr>
<tr>
<td headers="row" class="gt_row gt_right">1</td>
<td headers="col" class="gt_row gt_right">3</td>
<td headers="SampleIndex" class="gt_row gt_right">3</td>
<td headers="Compound" class="gt_row gt_center">Compound02</td>
<td headers="trueEffect" class="gt_row gt_right">10.111003</td>
<td headers="plateEffect" class="gt_row gt_right">2.474874</td>
<td headers="measurement" class="gt_row gt_right">12.58588</td>
</tr>
<tr>
<td headers="row" class="gt_row gt_right">1</td>
<td headers="col" class="gt_row gt_right">4</td>
<td headers="SampleIndex" class="gt_row gt_right">4</td>
<td headers="Compound" class="gt_row gt_center">Compound03</td>
<td headers="trueEffect" class="gt_row gt_right">9.640621</td>
<td headers="plateEffect" class="gt_row gt_right">2.150581</td>
<td headers="measurement" class="gt_row gt_right">11.79120</td>
</tr>
<tr>
<td headers="row" class="gt_row gt_right">1</td>
<td headers="col" class="gt_row gt_right">5</td>
<td headers="SampleIndex" class="gt_row gt_right">5</td>
<td headers="Compound" class="gt_row gt_center">Compound04</td>
<td headers="trueEffect" class="gt_row gt_right">9.466205</td>
<td headers="plateEffect" class="gt_row gt_right">1.903943</td>
<td headers="measurement" class="gt_row gt_right">11.37015</td>
</tr>
<tr>
<td headers="row" class="gt_row gt_right">1</td>
<td headers="col" class="gt_row gt_right">6</td>
<td headers="SampleIndex" class="gt_row gt_right">6</td>
<td headers="Compound" class="gt_row gt_center">Compound05</td>
<td headers="trueEffect" class="gt_row gt_right">11.049547</td>
<td headers="plateEffect" class="gt_row gt_right">1.767767</td>
<td headers="measurement" class="gt_row gt_right">12.81731</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>  plotlist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/plot_plate.html">plot_plate</a></span><span class="op">(</span><span class="va">dat</span>,</span>
<span>      plate <span class="op">=</span> <span class="va">plate</span>,</span>
<span>      row <span class="op">=</span> <span class="va">row</span>, column <span class="op">=</span> <span class="va">col</span>, .color <span class="op">=</span> <span class="va">Compound</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"Layout by treatment"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/plot_plate.html">plot_plate</a></span><span class="op">(</span><span class="va">dat</span>,</span>
<span>      plate <span class="op">=</span> <span class="va">plate</span>, row <span class="op">=</span> <span class="va">row</span>, column <span class="op">=</span> <span class="va">col</span>, .color <span class="op">=</span> <span class="va">trueEffect</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"True effect"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/plot_plate.html">plot_plate</a></span><span class="op">(</span><span class="va">dat</span>,</span>
<span>      plate <span class="op">=</span> <span class="va">plate</span>, row <span class="op">=</span> <span class="va">row</span>, column <span class="op">=</span> <span class="va">col</span>, .color <span class="op">=</span> <span class="va">plateEffect</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"Plate effect"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/plot_plate.html">plot_plate</a></span><span class="op">(</span><span class="va">dat</span>,</span>
<span>      plate <span class="op">=</span> <span class="va">plate</span>, row <span class="op">=</span> <span class="va">row</span>, column <span class="op">=</span> <span class="va">col</span>, .color <span class="op">=</span> <span class="va">measurement</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"Measurement"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="false_positives_files/figure-html/rawPlatePlots-1.png" width="768"></p>
<p>When we perform an one-way ANOVA test with the true effect, the
F-test suggests that there are no significant differences between the
treatments (p&gt;0.05).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">trueEffect</span> <span class="op">~</span> <span class="va">Compound</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Df Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span><span class="co">#&gt; Compound    11   7.61  0.6917   0.657  0.774</span></span>
<span><span class="co">#&gt; Residuals   84  88.43  1.0528</span></span></code></pre></div>
<p>However, if we consider the measurement, which sums the true effect
and the plate effect, the F-test suggests that there are significant
differences between the compounds (p&lt;0.01).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">measurement</span> <span class="op">~</span> <span class="va">Compound</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Df Sum Sq Mean Sq F value  Pr(&gt;F)   </span></span>
<span><span class="co">#&gt; Compound    11  41.12   3.738   2.925 0.00258 **</span></span>
<span><span class="co">#&gt; Residuals   84 107.34   1.278                   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>To verify, we calculate Turkey’s honest significant differences using
true effect. As expected, no single compound shows significant
difference from the effect of DMSO (adjusted p-value&gt;0.05)</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">versusDMSO</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">conditions</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"-"</span>, <span class="va">conditions</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">trueDiff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span></span>
<span>  <span class="va">trueEffect</span> <span class="op">~</span> <span class="va">Compound</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dat</span></span>
<span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">Compound</span></span>
<span><span class="va">trueDiff</span><span class="op">[</span><span class="va">versusDMSO</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;                        diff       lwr      upr     p adj</span></span>
<span><span class="co">#&gt; Compound01-DMSO -0.15660919 -1.881368 1.568150 1.0000000</span></span>
<span><span class="co">#&gt; Compound02-DMSO  0.16041021 -1.564349 1.885169 1.0000000</span></span>
<span><span class="co">#&gt; Compound03-DMSO -0.26495737 -1.989716 1.459802 0.9999957</span></span>
<span><span class="co">#&gt; Compound04-DMSO  0.12799598 -1.596763 1.852755 1.0000000</span></span>
<span><span class="co">#&gt; Compound05-DMSO  0.15392185 -1.570837 1.878681 1.0000000</span></span>
<span><span class="co">#&gt; Compound06-DMSO -0.29447551 -2.019235 1.430284 0.9999872</span></span>
<span><span class="co">#&gt; Compound07-DMSO  0.07293908 -1.651820 1.797698 1.0000000</span></span>
<span><span class="co">#&gt; Compound08-DMSO  0.46903318 -1.255726 2.193792 0.9988016</span></span>
<span><span class="co">#&gt; Compound09-DMSO  0.49798875 -1.226770 2.222748 0.9979416</span></span>
<span><span class="co">#&gt; Compound10-DMSO -0.09048129 -1.815240 1.634278 1.0000000</span></span>
<span><span class="co">#&gt; Compound11-DMSO -0.47509699 -2.199856 1.249662 0.9986527</span></span></code></pre></div>
<p>However, calculating the differences with measurements reveal that
Compound 6 would have a significant difference in viability from that of
DMSO (adjusted p&lt;0.01).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">measureDiff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">measurement</span> <span class="op">~</span> <span class="va">Compound</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dat</span></span>
<span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">Compound</span></span>
<span><span class="va">measureDiff</span><span class="op">[</span><span class="va">versusDMSO</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;                       diff       lwr        upr       p adj</span></span>
<span><span class="co">#&gt; Compound01-DMSO -0.6146694 -2.514910  1.2855708 0.994474856</span></span>
<span><span class="co">#&gt; Compound02-DMSO -0.7383338 -2.638574  1.1619064 0.976093386</span></span>
<span><span class="co">#&gt; Compound03-DMSO -1.5752825 -3.475523  0.3249577 0.204689940</span></span>
<span><span class="co">#&gt; Compound04-DMSO -1.5418117 -3.442052  0.3584285 0.231362089</span></span>
<span><span class="co">#&gt; Compound05-DMSO -1.7724524 -3.672693  0.1277878 0.091021614</span></span>
<span><span class="co">#&gt; Compound06-DMSO -2.2208497 -4.121090 -0.3206095 0.008978303</span></span>
<span><span class="co">#&gt; Compound07-DMSO -1.5968686 -3.497109  0.3033716 0.188684312</span></span>
<span><span class="co">#&gt; Compound08-DMSO -0.8412919 -2.741532  1.0589483 0.939725524</span></span>
<span><span class="co">#&gt; Compound09-DMSO -0.4007553 -2.300996  1.4994849 0.999893315</span></span>
<span><span class="co">#&gt; Compound10-DMSO -0.5485415 -2.448782  1.3516987 0.997945430</span></span>
<span><span class="co">#&gt; Compound11-DMSO -0.4750970 -2.375337  1.4251432 0.999450309</span></span></code></pre></div>
<p>We can also detect the difference visually with a Box-Whisker
plot.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">dat</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Compound</span>, y <span class="op">=</span> <span class="va">measurement</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Measurement [w/o randomization]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="false_positives_files/figure-html/boxplot-1.png" width="480"></p>
<p>Given that our simulation study assumed that no single compound
affects cell viability significantly differently from DMSO controls. So
the addition of plate effect causes one false discovery in this
simulation. It can be expected that the false-discovery rate may vary
depending on the relative strength and variability of the plate effect
with regard to the true effects. What matters most is the observation
that in the presence of plate effect, a lack of randomization, i.e. a
correlation of treatment with plate positions, may cause wrong
inferences.</p>
</div>
<div class="section level2">
<h2 id="randomization-prevents-plate-effect-from-interfering-with-inferences">Randomization prevents plate effect from interfering with
inferences<a class="anchor" aria-label="anchor" href="#randomization-prevents-plate-effect-from-interfering-with-inferences"></a>
</h2>
<p>Now we use the all but one assumptions made above, with the only
change that we shall randomize the layout of the samples. The
randomization will break the correlation between treatments and plate
effects.</p>
<p>We use the builting function <code>mk_plate_scoring_functions</code>
to define the scoring functions for the plate layout. We then use the
<code>optimize_design</code> function to randomize the layout of the
samples.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2307111</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bc_rnd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/optimize_design.html">optimize_design</a></span><span class="op">(</span></span>
<span>  <span class="va">bc</span>,</span>
<span>  scoring <span class="op">=</span> <span class="fu"><a href="../reference/mk_plate_scoring_functions.html">mk_plate_scoring_functions</a></span><span class="op">(</span><span class="va">bc</span>,</span>
<span>    row <span class="op">=</span> <span class="st">"row"</span>, column <span class="op">=</span> <span class="st">"col"</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"Compound"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We add plate effect to the randomized data and calculate the
measurement.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_rnd</span> <span class="op">&lt;-</span> <span class="fu">get_observations</span><span class="op">(</span><span class="va">bc_rnd</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_rnd</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div id="cxfrnpxiuy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#cxfrnpxiuy table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cxfrnpxiuy thead, #cxfrnpxiuy tbody, #cxfrnpxiuy tfoot, #cxfrnpxiuy tr, #cxfrnpxiuy td, #cxfrnpxiuy th {
  border-style: none;
}

#cxfrnpxiuy p {
  margin: 0;
  padding: 0;
}

#cxfrnpxiuy .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cxfrnpxiuy .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cxfrnpxiuy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cxfrnpxiuy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cxfrnpxiuy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cxfrnpxiuy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cxfrnpxiuy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cxfrnpxiuy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cxfrnpxiuy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cxfrnpxiuy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cxfrnpxiuy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cxfrnpxiuy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cxfrnpxiuy .gt_spanner_row {
  border-bottom-style: hidden;
}

#cxfrnpxiuy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cxfrnpxiuy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cxfrnpxiuy .gt_from_md > :first-child {
  margin-top: 0;
}

#cxfrnpxiuy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cxfrnpxiuy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cxfrnpxiuy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#cxfrnpxiuy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cxfrnpxiuy .gt_row_group_first td {
  border-top-width: 2px;
}

#cxfrnpxiuy .gt_row_group_first th {
  border-top-width: 2px;
}

#cxfrnpxiuy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cxfrnpxiuy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cxfrnpxiuy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cxfrnpxiuy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cxfrnpxiuy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cxfrnpxiuy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cxfrnpxiuy .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cxfrnpxiuy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cxfrnpxiuy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cxfrnpxiuy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cxfrnpxiuy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cxfrnpxiuy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cxfrnpxiuy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cxfrnpxiuy .gt_left {
  text-align: left;
}

#cxfrnpxiuy .gt_center {
  text-align: center;
}

#cxfrnpxiuy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cxfrnpxiuy .gt_font_normal {
  font-weight: normal;
}

#cxfrnpxiuy .gt_font_bold {
  font-weight: bold;
}

#cxfrnpxiuy .gt_font_italic {
  font-style: italic;
}

#cxfrnpxiuy .gt_super {
  font-size: 65%;
}

#cxfrnpxiuy .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cxfrnpxiuy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cxfrnpxiuy .gt_indent_1 {
  text-indent: 5px;
}

#cxfrnpxiuy .gt_indent_2 {
  text-indent: 10px;
}

#cxfrnpxiuy .gt_indent_3 {
  text-indent: 15px;
}

#cxfrnpxiuy .gt_indent_4 {
  text-indent: 20px;
}

#cxfrnpxiuy .gt_indent_5 {
  text-indent: 25px;
}

#cxfrnpxiuy .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#cxfrnpxiuy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="row">row</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="col">col</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="SampleIndex">SampleIndex</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Compound">Compound</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="trueEffect">trueEffect</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="plateEffect">plateEffect</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="measurement">measurement</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="row" class="gt_row gt_right">1</td>
<td headers="col" class="gt_row gt_right">1</td>
<td headers="SampleIndex" class="gt_row gt_right">1</td>
<td headers="Compound" class="gt_row gt_center">DMSO</td>
<td headers="trueEffect" class="gt_row gt_right">9.530078</td>
<td headers="plateEffect" class="gt_row gt_right">3.259601</td>
<td headers="measurement" class="gt_row gt_right">12.78968</td>
</tr>
<tr>
<td headers="row" class="gt_row gt_right">1</td>
<td headers="col" class="gt_row gt_right">2</td>
<td headers="SampleIndex" class="gt_row gt_right">24</td>
<td headers="Compound" class="gt_row gt_center">Compound11</td>
<td headers="trueEffect" class="gt_row gt_right">7.810705</td>
<td headers="plateEffect" class="gt_row gt_right">2.850439</td>
<td headers="measurement" class="gt_row gt_right">10.66114</td>
</tr>
<tr>
<td headers="row" class="gt_row gt_right">1</td>
<td headers="col" class="gt_row gt_right">3</td>
<td headers="SampleIndex" class="gt_row gt_right">57</td>
<td headers="Compound" class="gt_row gt_center">Compound08</td>
<td headers="trueEffect" class="gt_row gt_right">8.419993</td>
<td headers="plateEffect" class="gt_row gt_right">2.474874</td>
<td headers="measurement" class="gt_row gt_right">10.89487</td>
</tr>
<tr>
<td headers="row" class="gt_row gt_right">1</td>
<td headers="col" class="gt_row gt_right">4</td>
<td headers="SampleIndex" class="gt_row gt_right">4</td>
<td headers="Compound" class="gt_row gt_center">Compound03</td>
<td headers="trueEffect" class="gt_row gt_right">9.640621</td>
<td headers="plateEffect" class="gt_row gt_right">2.150581</td>
<td headers="measurement" class="gt_row gt_right">11.79120</td>
</tr>
<tr>
<td headers="row" class="gt_row gt_right">1</td>
<td headers="col" class="gt_row gt_right">5</td>
<td headers="SampleIndex" class="gt_row gt_right">91</td>
<td headers="Compound" class="gt_row gt_center">Compound06</td>
<td headers="trueEffect" class="gt_row gt_right">10.952227</td>
<td headers="plateEffect" class="gt_row gt_right">1.903943</td>
<td headers="measurement" class="gt_row gt_right">12.85617</td>
</tr>
<tr>
<td headers="row" class="gt_row gt_right">1</td>
<td headers="col" class="gt_row gt_right">6</td>
<td headers="SampleIndex" class="gt_row gt_right">94</td>
<td headers="Compound" class="gt_row gt_center">Compound09</td>
<td headers="trueEffect" class="gt_row gt_right">11.928334</td>
<td headers="plateEffect" class="gt_row gt_right">1.767767</td>
<td headers="measurement" class="gt_row gt_right">13.69610</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>  plotlist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/plot_plate.html">plot_plate</a></span><span class="op">(</span><span class="va">dat_rnd</span>,</span>
<span>      plate <span class="op">=</span> <span class="va">plate</span>,</span>
<span>      row <span class="op">=</span> <span class="va">row</span>, column <span class="op">=</span> <span class="va">col</span>, .color <span class="op">=</span> <span class="va">Compound</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"Layout by treatment"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/plot_plate.html">plot_plate</a></span><span class="op">(</span><span class="va">dat_rnd</span>,</span>
<span>      plate <span class="op">=</span> <span class="va">plate</span>, row <span class="op">=</span> <span class="va">row</span>, column <span class="op">=</span> <span class="va">col</span>, .color <span class="op">=</span> <span class="va">trueEffect</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"True effect"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/plot_plate.html">plot_plate</a></span><span class="op">(</span><span class="va">dat_rnd</span>,</span>
<span>      plate <span class="op">=</span> <span class="va">plate</span>, row <span class="op">=</span> <span class="va">row</span>, column <span class="op">=</span> <span class="va">col</span>, .color <span class="op">=</span> <span class="va">plateEffect</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"Plate effect"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/plot_plate.html">plot_plate</a></span><span class="op">(</span><span class="va">dat_rnd</span>,</span>
<span>      plate <span class="op">=</span> <span class="va">plate</span>, row <span class="op">=</span> <span class="va">row</span>, column <span class="op">=</span> <span class="va">col</span>, .color <span class="op">=</span> <span class="va">measurement</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"Measurement"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="false_positives_files/figure-html/randomPlatePlots-1.png" width="768"></p>
<p>When we apply the F-test, we detect no significant differences
between any compound and DMSO.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">randMeasureDiff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">measurement</span> <span class="op">~</span> <span class="va">Compound</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dat_rnd</span></span>
<span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">Compound</span></span>
<span><span class="va">randMeasureDiff</span><span class="op">[</span><span class="va">versusDMSO</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;                        diff       lwr      upr     p adj</span></span>
<span><span class="co">#&gt; Compound01-DMSO -0.05930995 -2.268768 2.150148 1.0000000</span></span>
<span><span class="co">#&gt; Compound02-DMSO  0.10429864 -2.105160 2.313757 1.0000000</span></span>
<span><span class="co">#&gt; Compound03-DMSO -0.41812087 -2.627579 1.791337 0.9999637</span></span>
<span><span class="co">#&gt; Compound04-DMSO  0.08581910 -2.123639 2.295277 1.0000000</span></span>
<span><span class="co">#&gt; Compound05-DMSO  0.18471545 -2.024743 2.394174 1.0000000</span></span>
<span><span class="co">#&gt; Compound06-DMSO -0.33999104 -2.549449 1.869467 0.9999956</span></span>
<span><span class="co">#&gt; Compound07-DMSO  0.08156504 -2.127893 2.291023 1.0000000</span></span>
<span><span class="co">#&gt; Compound08-DMSO  0.35967314 -1.849785 2.569132 0.9999922</span></span>
<span><span class="co">#&gt; Compound09-DMSO  0.30525718 -1.904201 2.514716 0.9999986</span></span>
<span><span class="co">#&gt; Compound10-DMSO -0.05702472 -2.266483 2.152434 1.0000000</span></span>
<span><span class="co">#&gt; Compound11-DMSO -0.52416017 -2.733619 1.685298 0.9996658</span></span></code></pre></div>
<p>We can also use the boxplot as a visual help to inspect the
difference between the treatments, to confirm that randomization
prevents plate effect from affecting the statistical inference.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">dat_rnd</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Compound</span>, y <span class="op">=</span> <span class="va">measurement</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Measurement [with randomization]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="false_positives_files/figure-html/randBoxplot-1.png" width="480"></p>
</div>
<div class="section level2">
<h2 id="discussions-and-conclusions">Discussions and conclusions<a class="anchor" aria-label="anchor" href="#discussions-and-conclusions"></a>
</h2>
<p>The simple case study discussed in this vignette is an application of
generative models, which means that assuming that we know the mechanism
by which the data is generated, we can simulate the data generation
process and use it for various purposes. In our cases, we simulated a
linear additive model of true effects of compounds and control on cell
viability and the plate effect induced by positions in a microtitre
plate. Using the model, we demonstrate that (1) plate effect can impact
statistical inference by introducing false positive (and in other case,
false negative) findings, and (2) a full randomization can guard
statistical inference by reducing the bias of the plate effect.</p>
<p>While the case study is on the margin of being overly simple, we hope
that it demonstrates the advantage of appropriate experiment design
using tools like <code>designit</code>, as well as the necessity of
statistical techniques such as randomization and blocking in drug
discovery and development.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Iakov I. Davydov, Juliane Siebourg-Polster, Guido Steiner, Jitao David Zhang, Balazs Banfai.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
