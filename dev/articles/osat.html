<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OSAT and scoring functions • designit</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="OSAT and scoring functions">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">designit</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.5.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basic_examples.html">Basic example</a>
    </li>
    <li>
      <a href="../articles/custom_shuffle.html">Using custom shuffle schedule</a>
    </li>
    <li>
      <a href="../articles/invivo_study_design.html">In-vivo study design</a>
    </li>
    <li>
      <a href="../articles/NCS22_talk.html">designit: a flexible engine to generate experiment layouts</a>
    </li>
    <li>
      <a href="../articles/nested_dimensions_examples.html">Nested dimension example</a>
    </li>
    <li>
      <a href="../articles/optimizer_examples.html">Optimizer examples</a>
    </li>
    <li>
      <a href="../articles/osat.html">OSAT and scoring functions</a>
    </li>
    <li>
      <a href="../articles/plate_layouts.html">Plate layouts</a>
    </li>
    <li>
      <a href="../articles/plate_scoring_examples.html">Plate scoring examples</a>
    </li>
    <li>
      <a href="../articles/shuffling_with_constraints.html">Shuffling with constraints</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/BEDApub/designit" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>OSAT and scoring functions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/BEDApub/designit/tree/main/vignettes/osat.Rmd" class="external-link"><code>vignettes/osat.Rmd</code></a></small>
      <div class="hidden name"><code>osat.Rmd</code></div>

    </div>

    
    
<p>In this vignette, we demonstrate how to use the OSAT score (<a href="https://doi.org/10.1186/1471-2164-13-689" class="external-link">Yan et
al. (2012)</a>).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bedapub.github.io/designit/">designit</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Attaching core tidyverse packages</span> ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr    </span> 1.1.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr    </span> 2.1.5</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats  </span> 1.0.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr  </span> 1.5.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2  </span> 3.5.1     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble   </span> 3.2.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">lubridate</span> 1.9.3     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr    </span> 1.3.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr    </span> 1.0.2     </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"OSAT"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"This vignette can only be rendered if `OSAT` package is installed."</span><span class="op">)</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/knit_exit.html" class="external-link">knit_exit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Loading required namespace: OSAT</span></span></code></pre></div>
<p>Loading samples. We add two dummy columns to demonstrate how to
choose batch columns of interest.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">osat_data_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"OSAT"</span><span class="op">)</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">osat_data_path</span>, <span class="st">"samples.txt"</span><span class="op">)</span>,</span>
<span>  col_types <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/cols.html" class="external-link">cols</a></span><span class="op">(</span>SampleType <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_factor.html" class="external-link">col_factor</a></span><span class="op">(</span><span class="op">)</span>, Race <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_factor.html" class="external-link">col_factor</a></span><span class="op">(</span><span class="op">)</span>, AgeGrp <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_factor.html" class="external-link">col_factor</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>dummy_var1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, dummy_var2 <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html" class="external-link">str_c</a></span><span class="op">(</span><span class="va">SampleType</span>, <span class="va">Race</span>, sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="running-osat-optimization">Running OSAT optimization<a class="anchor" aria-label="anchor" href="#running-osat-optimization"></a>
</h2>
<p>Here we use OSAT to optimize setup.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu">OSAT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/OSAT/man/gSample-class.html" class="external-link">setup.sample</a></span><span class="op">(</span><span class="va">samples</span>, optimal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SampleType"</span>, <span class="st">"Race"</span>, <span class="st">"AgeGrp"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gc</span> <span class="op">&lt;-</span> <span class="fu">OSAT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/OSAT/man/gContainer-class.html" class="external-link">setup.container</a></span><span class="op">(</span><span class="fu">OSAT</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/OSAT/man/BeadPlate-class.html" class="external-link">IlluminaBeadChip96Plate</a></span>, <span class="fl">7</span>, batch <span class="op">=</span> <span class="st">"plates"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">bench</span><span class="fu">::</span><span class="fu"><a href="http://bench.r-lib.org/reference/bench_time.html" class="external-link">system_time</a></span><span class="op">(</span></span>
<span>  <span class="va">g_setup</span> <span class="op">&lt;-</span> <span class="fu">OSAT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/OSAT/man/create.optimized.setup.html" class="external-link">create.optimized.setup</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">gs</span>, container <span class="op">=</span> <span class="va">gc</span>, nSim <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">iterations</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in OSAT::create.optimized.setup(sample = gs, container = gc, nSim =</span></span>
<span><span class="co">#&gt; params$iterations): Using default optimization method: optimal.shuffle</span></span>
<span><span class="co">#&gt; process    real </span></span>
<span><span class="co">#&gt;   910ms   910ms</span></span>
<span></span>
<span><span class="fu">OSAT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/OSAT/man/QC.html" class="external-link">QC</a></span><span class="op">(</span><span class="va">g_setup</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test independence between "plates" and sample variables</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Pearson's Chi-squared test</span></span>
<span><span class="co">#&gt;          Var X-squared df   p.value</span></span>
<span><span class="co">#&gt; 1 SampleType 0.4938509  6 0.9979125</span></span>
<span><span class="co">#&gt; 2       Race 0.7424849  6 0.9935279</span></span>
<span><span class="co">#&gt; 3     AgeGrp 1.8472070 24 1.0000000</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<p><img src="osat_files/figure-html/unnamed-chunk-3-1.png" width="576"></p>
<p>Saving starting point of optimization</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g_setup_start</span> <span class="op">&lt;-</span> <span class="fu">OSAT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/OSAT/man/create.optimized.setup.html" class="external-link">create.optimized.setup</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">gs</span>, container <span class="op">=</span> <span class="va">gc</span>, nSim <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">OSAT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/OSAT/man/get.experiment.setup.html" class="external-link">get.experiment.setup</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in OSAT::create.optimized.setup(sample = gs, container = gc, nSim = 1):</span></span>
<span><span class="co">#&gt; Using default optimization method: optimal.shuffle</span></span></code></pre></div>
<p>Visualize various batch factors. OSAT score is optimized only for
<code>plates</code> in this case.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">OSAT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/OSAT/man/get.experiment.setup.html" class="external-link">get.experiment.setup</a></span><span class="op">(</span><span class="va">g_setup</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">AgeGrp</span>, <span class="va">plates</span>, <span class="va">chipRows</span>, <span class="va">chipColumns</span>, <span class="va">chips</span>, <span class="va">rows</span>, <span class="va">columns</span>, <span class="va">wells</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">AgeGrp</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">AgeGrp</span>, <span class="va">value</span>, <span class="va">name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">AgeGrp</span>, <span class="va">n</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span></code></pre></div>
<p><img src="osat_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<div class="section level3">
<h3 id="visualize-for-plates">Visualize for plates<a class="anchor" aria-label="anchor" href="#visualize-for-plates"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_batch</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">plates</span>, <span class="va">SampleType</span>, <span class="va">Race</span>, <span class="va">AgeGrp</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">SampleType</span>, <span class="va">Race</span>, <span class="va">AgeGrp</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"variable"</span>, values_to <span class="op">=</span> <span class="st">"level"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">plates</span>, <span class="va">variable</span>, <span class="va">level</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">level</span>, <span class="va">n</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">plates</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, scales <span class="op">=</span> <span class="st">"free"</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Before the optimization.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g_setup_start</span> <span class="op">|&gt;</span> <span class="fu">plot_batch</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="osat_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
<p>After the optimization.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">OSAT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/OSAT/man/get.experiment.setup.html" class="external-link">get.experiment.setup</a></span><span class="op">(</span><span class="va">g_setup</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plot_batch</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="osat_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
</div>
</div>
<div class="section level2">
<h2 id="compare-scores-with-various-implementations">Compare scores with various implementations<a class="anchor" aria-label="anchor" href="#compare-scores-with-various-implementations"></a>
</h2>
<p>Compare OSAT score generated using designit.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">OSAT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/OSAT/man/gArray-class.html" class="external-link">getLayout</a></span><span class="op">(</span><span class="va">gc</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="fu">OSAT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/OSAT/man/get.experiment.setup.html" class="external-link">get.experiment.setup</a></span><span class="op">(</span><span class="va">g_setup</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/osat_score.html">osat_score</a></span><span class="op">(</span><span class="st">"plates"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SampleType"</span>, <span class="st">"Race"</span>, <span class="st">"AgeGrp"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">score</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(plates, chipRows, chipColumns, chips, rows, columns,</span></span>
<span><span class="co">#&gt; wells)`</span></span>
<span><span class="co">#&gt; Warning in osat_score(data.table::data.table(left_join(OSAT::getLayout(gc), :</span></span>
<span><span class="co">#&gt; NAs in features / batch columns; they will be excluded from scoring</span></span>
<span><span class="co">#&gt; [1] 34.85714</span></span>
<span></span>
<span><span class="co"># score using OSAT</span></span>
<span><span class="va">g_setup</span><span class="op">@</span><span class="va">metadata</span><span class="op">$</span><span class="va">optValue</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 34.85714</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="run-using-batchcontainer">Run using BatchContainer<a class="anchor" aria-label="anchor" href="#run-using-batchcontainer"></a>
</h2>
<p>First let’s create a BatchContainer with same dimensions.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bc</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/BatchContainer.html">BatchContainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>plates <span class="op">=</span> <span class="fl">7</span>, chips <span class="op">=</span> <span class="fl">8</span>, rows <span class="op">=</span> <span class="fl">6</span>, columns <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">bc</span></span>
<span><span class="co">#&gt; Batch container with 672 locations.</span></span>
<span><span class="co">#&gt;   Dimensions: plates, chips, rows, columns</span></span>
<span></span>
<span><span class="va">bc</span><span class="op">$</span><span class="va">n_locations</span></span>
<span><span class="co">#&gt; [1] 672</span></span></code></pre></div>
<p>Assign samples and get initial setup.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assign_in_order.html">assign_in_order</a></span><span class="op">(</span><span class="va">bc</span>, <span class="va">samples</span><span class="op">)</span></span>
<span></span>
<span><span class="va">starting_assignment</span> <span class="op">&lt;-</span> <span class="va">bc</span><span class="op">$</span><span class="fu">get_locations</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">g_setup_start</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(plates, chips, rows, columns)`</span></span>
<span></span>
<span><span class="va">bc</span><span class="op">$</span><span class="fu">move_samples</span><span class="op">(</span>location_assignment <span class="op">=</span> <span class="va">starting_assignment</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bc</span><span class="op">$</span><span class="fu">get_samples</span><span class="op">(</span>remove_empty_locations <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plot_batch</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="osat_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
<div class="section level3">
<h3 id="using-designit-osat-score-implementation">Using designit OSAT score implementation<a class="anchor" aria-label="anchor" href="#using-designit-osat-score-implementation"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scoring_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/osat_score_generator.html">osat_score_generator</a></span><span class="op">(</span><span class="st">"plates"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SampleType"</span>, <span class="st">"Race"</span>, <span class="st">"AgeGrp"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bc</span><span class="op">$</span><span class="fu">score</span><span class="op">(</span><span class="va">scoring_f</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in osat_score(bc, batch_vars = batch_vars, feature_vars = feature_vars,</span></span>
<span><span class="co">#&gt; : NAs in features / batch columns; they will be excluded from scoring</span></span>
<span><span class="co">#&gt;  score_1 </span></span>
<span><span class="co">#&gt; 360.8571</span></span>
<span><span class="va">g_setup</span><span class="op">@</span><span class="va">metadata</span><span class="op">$</span><span class="va">optValue</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 360.8571</span></span>
<span><span class="co"># should be identical</span></span>
<span></span>
<span><span class="fu">bench</span><span class="fu">::</span><span class="fu"><a href="http://bench.r-lib.org/reference/bench_time.html" class="external-link">system_time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span>  <span class="va">bc_reference</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/optimize_design.html">optimize_design</a></span><span class="op">(</span><span class="va">bc</span>, scoring <span class="op">=</span> <span class="va">scoring_f</span>, max_iter <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">iterations</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; Checking variances of 1-dim. score vector.</span></span>
<span><span class="co">#&gt; ... (6749.04) - OK</span></span>
<span><span class="co">#&gt; Initial score: 360.857</span></span>
<span><span class="co">#&gt; Achieved score: 348.857 at iteration 7</span></span>
<span><span class="co">#&gt; Achieved score: 344.857 at iteration 8</span></span>
<span><span class="co">#&gt; Achieved score: 338.857 at iteration 10</span></span>
<span><span class="co">#&gt; Achieved score: 326.857 at iteration 19</span></span>
<span><span class="co">#&gt; Achieved score: 322.857 at iteration 22</span></span>
<span><span class="co">#&gt; Achieved score: 320.857 at iteration 24</span></span>
<span><span class="co">#&gt; Achieved score: 318.857 at iteration 26</span></span>
<span><span class="co">#&gt; Achieved score: 314.857 at iteration 27</span></span>
<span><span class="co">#&gt; Achieved score: 308.857 at iteration 28</span></span>
<span><span class="co">#&gt; Achieved score: 302.857 at iteration 32</span></span>
<span><span class="co">#&gt; Achieved score: 300.857 at iteration 33</span></span>
<span><span class="co">#&gt; Achieved score: 292.857 at iteration 36</span></span>
<span><span class="co">#&gt; Achieved score: 290.857 at iteration 38</span></span>
<span><span class="co">#&gt; Achieved score: 284.857 at iteration 40</span></span>
<span><span class="co">#&gt; Achieved score: 276.857 at iteration 45</span></span>
<span><span class="co">#&gt; Achieved score: 272.857 at iteration 50</span></span>
<span><span class="co">#&gt; Achieved score: 266.857 at iteration 54</span></span>
<span><span class="co">#&gt; Achieved score: 258.857 at iteration 55</span></span>
<span><span class="co">#&gt; Achieved score: 248.857 at iteration 60</span></span>
<span><span class="co">#&gt; Achieved score: 242.857 at iteration 62</span></span>
<span><span class="co">#&gt; Achieved score: 224.857 at iteration 71</span></span>
<span><span class="co">#&gt; Achieved score: 218.857 at iteration 73</span></span>
<span><span class="co">#&gt; Achieved score: 214.857 at iteration 76</span></span>
<span><span class="co">#&gt; Achieved score: 204.857 at iteration 78</span></span>
<span><span class="co">#&gt; Achieved score: 200.857 at iteration 79</span></span>
<span><span class="co">#&gt; Achieved score: 192.857 at iteration 80</span></span>
<span><span class="co">#&gt; Achieved score: 184.857 at iteration 84</span></span>
<span><span class="co">#&gt; Achieved score: 176.857 at iteration 85</span></span>
<span><span class="co">#&gt; Achieved score: 172.857 at iteration 86</span></span>
<span><span class="co">#&gt; Achieved score: 170.857 at iteration 95</span></span>
<span><span class="co">#&gt; Achieved score: 166.857 at iteration 96</span></span>
<span><span class="co">#&gt; Achieved score: 156.857 at iteration 98</span></span>
<span><span class="co">#&gt; Achieved score: 150.857 at iteration 99</span></span>
<span><span class="co">#&gt; Achieved score: 148.857 at iteration 102</span></span>
<span><span class="co">#&gt; Achieved score: 144.857 at iteration 103</span></span>
<span><span class="co">#&gt; Achieved score: 138.857 at iteration 113</span></span>
<span><span class="co">#&gt; Achieved score: 132.857 at iteration 133</span></span>
<span><span class="co">#&gt; Achieved score: 124.857 at iteration 138</span></span>
<span><span class="co">#&gt; Achieved score: 120.857 at iteration 140</span></span>
<span><span class="co">#&gt; Achieved score: 112.857 at iteration 149</span></span>
<span><span class="co">#&gt; Achieved score: 108.857 at iteration 169</span></span>
<span><span class="co">#&gt; Achieved score: 106.857 at iteration 175</span></span>
<span><span class="co">#&gt; Achieved score: 104.857 at iteration 176</span></span>
<span><span class="co">#&gt; Achieved score: 100.857 at iteration 178</span></span>
<span><span class="co">#&gt; Achieved score: 98.857 at iteration 179</span></span>
<span><span class="co">#&gt; Achieved score: 92.857 at iteration 188</span></span>
<span><span class="co">#&gt; Achieved score: 90.857 at iteration 189</span></span>
<span><span class="co">#&gt; Achieved score: 86.857 at iteration 190</span></span>
<span><span class="co">#&gt; Achieved score: 82.857 at iteration 202</span></span>
<span><span class="co">#&gt; Achieved score: 76.857 at iteration 210</span></span>
<span><span class="co">#&gt; Achieved score: 72.857 at iteration 223</span></span>
<span><span class="co">#&gt; Achieved score: 68.857 at iteration 231</span></span>
<span><span class="co">#&gt; Achieved score: 66.857 at iteration 239</span></span>
<span><span class="co">#&gt; Achieved score: 64.857 at iteration 262</span></span>
<span><span class="co">#&gt; Achieved score: 62.857 at iteration 324</span></span>
<span><span class="co">#&gt; Achieved score: 60.857 at iteration 336</span></span>
<span><span class="co">#&gt; Achieved score: 58.857 at iteration 358</span></span>
<span><span class="co">#&gt; Achieved score: 56.857 at iteration 360</span></span>
<span><span class="co">#&gt; Achieved score: 52.857 at iteration 406</span></span>
<span><span class="co">#&gt; Achieved score: 50.857 at iteration 419</span></span>
<span><span class="co">#&gt; Achieved score: 48.857 at iteration 425</span></span>
<span><span class="co">#&gt; Achieved score: 46.857 at iteration 455</span></span>
<span><span class="co">#&gt; Achieved score: 42.857 at iteration 505</span></span>
<span><span class="co">#&gt; Achieved score: 40.857 at iteration 507</span></span>
<span><span class="co">#&gt; Achieved score: 38.857 at iteration 532</span></span>
<span><span class="co">#&gt; Achieved score: 36.857 at iteration 618</span></span>
<span><span class="co">#&gt; Achieved score: 34.857 at iteration 727</span></span>
<span><span class="co">#&gt; Achieved score: 32.857 at iteration 786</span></span>
<span><span class="co">#&gt; Achieved score: 30.857 at iteration 960</span></span>
<span><span class="co">#&gt; process    real </span></span>
<span><span class="co">#&gt;   15.3s    7.9s</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># final score</span></span>
<span><span class="va">bc_reference</span><span class="op">$</span><span class="fu">score</span><span class="op">(</span><span class="va">scoring_f</span><span class="op">)</span></span>
<span><span class="co">#&gt;  score_1 </span></span>
<span><span class="co">#&gt; 30.85714</span></span>
<span><span class="va">bc_reference</span><span class="op">$</span><span class="fu">plot_trace</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html" class="external-link">str_glue</a></span><span class="op">(</span><span class="st">"Final score={bc$score(scoring_f)}"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="osat_files/figure-html/unnamed-chunk-13-1.png" width="576"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bc</span><span class="op">$</span><span class="fu">get_samples</span><span class="op">(</span>remove_empty_locations <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plot_batch</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="osat_files/figure-html/unnamed-chunk-13-2.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="manually-work-with-data-table">Manually work with <code>data.table</code><a class="anchor" aria-label="anchor" href="#manually-work-with-data-table"></a>
</h3>
<p>Instead of relying on <code>BatchContainer</code>, here we have a
manual optimization process using <code>data.table</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fast_osat_optimize</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">bc</span>, <span class="va">batch_vars</span>, <span class="va">feature_vars</span>, <span class="va">iterations</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">bc</span> <span class="op">&lt;-</span> <span class="va">bc</span><span class="op">$</span><span class="fu">copy</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">ldf</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="va">bc</span><span class="op">$</span><span class="fu">get_locations</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"plates"</span><span class="op">)</span><span class="op">]</span><span class="op">[</span>, <span class="st">".sample_id"</span> <span class="op">:=</span> <span class="va">bc</span><span class="op">$</span><span class="va">assignment</span><span class="op">]</span></span>
<span>  <span class="va">fcols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">".sample_id"</span>, <span class="va">feature_vars</span><span class="op">)</span></span>
<span>  <span class="va">smp</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="va">bc</span><span class="op">$</span><span class="va">samples</span><span class="op">)</span><span class="op">[</span>, <span class="va">..fcols</span><span class="op">]</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">smp</span><span class="op">[</span><span class="va">ldf</span>, on <span class="op">=</span> <span class="st">".sample_id"</span><span class="op">]</span></span>
<span></span>
<span>  <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/osat_score.html">osat_score</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">batch_vars</span>, <span class="va">feature_vars</span><span class="op">)</span></span>
<span>  <span class="va">edf</span> <span class="op">&lt;-</span> <span class="va">v</span><span class="op">$</span><span class="va">expected_dt</span></span>
<span>  <span class="va">current_score</span> <span class="op">&lt;-</span> <span class="va">v</span><span class="op">$</span><span class="va">score</span></span>
<span>  <span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span>length <span class="op">=</span> <span class="va">iterations</span><span class="op">)</span></span>
<span>  <span class="va">n_avail</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">iterations</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">repeat</span> <span class="op">{</span></span>
<span>      <span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">n_avail</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span>      <span class="co"># does not make sense to shuffle NAs</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="va">pos</span>, <span class="va">feature_vars</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">break</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="va">val</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pos</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">pos</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="va">fcols</span>, with <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span>    <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pos</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">pos</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="op">(</span><span class="va">fcols</span><span class="op">)</span> <span class="op">:=</span> <span class="va">val</span><span class="op">]</span></span>
<span></span>
<span>    <span class="va">new_score</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/osat_score.html">osat_score</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">batch_vars</span>, <span class="va">feature_vars</span>, <span class="va">edf</span><span class="op">)</span><span class="op">$</span><span class="va">score</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">new_score</span> <span class="op">&lt;=</span> <span class="va">current_score</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">current_score</span> <span class="op">&lt;-</span> <span class="va">new_score</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pos</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">pos</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="op">(</span><span class="va">fcols</span><span class="op">)</span> <span class="op">:=</span> <span class="va">val</span><span class="op">]</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="va">scores</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">current_score</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">bc</span><span class="op">$</span><span class="va">assignment</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">.sample_id</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>bc<span class="op">=</span><span class="va">bc</span>, scores<span class="op">=</span><span class="va">scores</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">bench</span><span class="fu">::</span><span class="fu"><a href="http://bench.r-lib.org/reference/bench_time.html" class="external-link">system_time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span>  <span class="va">opt_res</span> <span class="op">&lt;-</span> <span class="fu">fast_osat_optimize</span><span class="op">(</span><span class="va">bc</span>, <span class="st">"plates"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SampleType"</span>, <span class="st">"Race"</span>, <span class="st">"AgeGrp"</span><span class="op">)</span>, iterations <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">iterations</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in osat_score(df, batch_vars, feature_vars): NAs in features / batch</span></span>
<span><span class="co">#&gt; columns; they will be excluded from scoring</span></span>
<span><span class="co">#&gt; Warning in (function (assignment) : this field might become read-only in the</span></span>
<span><span class="co">#&gt; future, please use $move_samples() instead</span></span>
<span><span class="co">#&gt; process    real </span></span>
<span><span class="co">#&gt;  10.17s   5.18s</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="shuffle-optimization-with-burn-in">Shuffle optimization with burn-in<a class="anchor" aria-label="anchor" href="#shuffle-optimization-with-burn-in"></a>
</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scoring_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/osat_score_generator.html">osat_score_generator</a></span><span class="op">(</span><span class="st">"plates"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SampleType"</span>, <span class="st">"Race"</span>, <span class="st">"AgeGrp"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">burn_in_it</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">iterations</span> <span class="op">*</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">burn_in_it</span></span>
<span><span class="co">#&gt; [1] 100</span></span>
<span></span>
<span><span class="fu">bench</span><span class="fu">::</span><span class="fu"><a href="http://bench.r-lib.org/reference/bench_time.html" class="external-link">system_time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span>  <span class="va">bc_burn_in</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/optimize_design.html">optimize_design</a></span><span class="op">(</span></span>
<span>    <span class="va">bc</span>,</span>
<span>    scoring <span class="op">=</span> <span class="va">scoring_f</span>,</span>
<span>    n_shuffle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">20</span>, <span class="va">burn_in_it</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span></span>
<span>        <span class="fl">2</span>,</span>
<span>        <span class="va">params</span><span class="op">$</span><span class="va">iterations</span> <span class="op">-</span> <span class="va">burn_in_it</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    max_iter <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">iterations</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in osat_score(bc, batch_vars = batch_vars, feature_vars = feature_vars,</span></span>
<span><span class="co">#&gt; : NAs in features / batch columns; they will be excluded from scoring</span></span>
<span><span class="co">#&gt; Checking variances of 1-dim. score vector.</span></span>
<span><span class="co">#&gt; ... (5018.697) - OK</span></span>
<span><span class="co">#&gt; Initial score: 360.857</span></span>
<span><span class="co">#&gt; Achieved score: 322.857 at iteration 1</span></span>
<span><span class="co">#&gt; Achieved score: 290.857 at iteration 5</span></span>
<span><span class="co">#&gt; Achieved score: 278.857 at iteration 7</span></span>
<span><span class="co">#&gt; Achieved score: 254.857 at iteration 8</span></span>
<span><span class="co">#&gt; Achieved score: 238.857 at iteration 15</span></span>
<span><span class="co">#&gt; Achieved score: 224.857 at iteration 28</span></span>
<span><span class="co">#&gt; Achieved score: 216.857 at iteration 32</span></span>
<span><span class="co">#&gt; Achieved score: 198.857 at iteration 34</span></span>
<span><span class="co">#&gt; Achieved score: 196.857 at iteration 50</span></span>
<span><span class="co">#&gt; Achieved score: 184.857 at iteration 54</span></span>
<span><span class="co">#&gt; Achieved score: 172.857 at iteration 59</span></span>
<span><span class="co">#&gt; Achieved score: 162.857 at iteration 75</span></span>
<span><span class="co">#&gt; Achieved score: 158.857 at iteration 80</span></span>
<span><span class="co">#&gt; Achieved score: 156.857 at iteration 101</span></span>
<span><span class="co">#&gt; Achieved score: 152.857 at iteration 102</span></span>
<span><span class="co">#&gt; Achieved score: 150.857 at iteration 103</span></span>
<span><span class="co">#&gt; Achieved score: 144.857 at iteration 104</span></span>
<span><span class="co">#&gt; Achieved score: 142.857 at iteration 112</span></span>
<span><span class="co">#&gt; Achieved score: 140.857 at iteration 114</span></span>
<span><span class="co">#&gt; Achieved score: 136.857 at iteration 115</span></span>
<span><span class="co">#&gt; Achieved score: 130.857 at iteration 118</span></span>
<span><span class="co">#&gt; Achieved score: 126.857 at iteration 136</span></span>
<span><span class="co">#&gt; Achieved score: 124.857 at iteration 139</span></span>
<span><span class="co">#&gt; Achieved score: 122.857 at iteration 142</span></span>
<span><span class="co">#&gt; Achieved score: 116.857 at iteration 145</span></span>
<span><span class="co">#&gt; Achieved score: 114.857 at iteration 146</span></span>
<span><span class="co">#&gt; Achieved score: 112.857 at iteration 147</span></span>
<span><span class="co">#&gt; Achieved score: 106.857 at iteration 150</span></span>
<span><span class="co">#&gt; Achieved score: 102.857 at iteration 153</span></span>
<span><span class="co">#&gt; Achieved score: 98.857 at iteration 161</span></span>
<span><span class="co">#&gt; Achieved score: 96.857 at iteration 165</span></span>
<span><span class="co">#&gt; Achieved score: 94.857 at iteration 167</span></span>
<span><span class="co">#&gt; Achieved score: 90.857 at iteration 191</span></span>
<span><span class="co">#&gt; Achieved score: 84.857 at iteration 194</span></span>
<span><span class="co">#&gt; Achieved score: 82.857 at iteration 198</span></span>
<span><span class="co">#&gt; Achieved score: 78.857 at iteration 202</span></span>
<span><span class="co">#&gt; Achieved score: 76.857 at iteration 211</span></span>
<span><span class="co">#&gt; Achieved score: 74.857 at iteration 232</span></span>
<span><span class="co">#&gt; Achieved score: 72.857 at iteration 238</span></span>
<span><span class="co">#&gt; Achieved score: 70.857 at iteration 268</span></span>
<span><span class="co">#&gt; Achieved score: 68.857 at iteration 295</span></span>
<span><span class="co">#&gt; Achieved score: 66.857 at iteration 297</span></span>
<span><span class="co">#&gt; Achieved score: 64.857 at iteration 316</span></span>
<span><span class="co">#&gt; Achieved score: 62.857 at iteration 324</span></span>
<span><span class="co">#&gt; Achieved score: 60.857 at iteration 402</span></span>
<span><span class="co">#&gt; Achieved score: 58.857 at iteration 405</span></span>
<span><span class="co">#&gt; Achieved score: 54.857 at iteration 409</span></span>
<span><span class="co">#&gt; Achieved score: 52.857 at iteration 436</span></span>
<span><span class="co">#&gt; Achieved score: 48.857 at iteration 440</span></span>
<span><span class="co">#&gt; Achieved score: 46.857 at iteration 499</span></span>
<span><span class="co">#&gt; Achieved score: 44.857 at iteration 521</span></span>
<span><span class="co">#&gt; Achieved score: 42.857 at iteration 562</span></span>
<span><span class="co">#&gt; Achieved score: 40.857 at iteration 621</span></span>
<span><span class="co">#&gt; Achieved score: 38.857 at iteration 788</span></span>
<span><span class="co">#&gt; Achieved score: 36.857 at iteration 793</span></span>
<span><span class="co">#&gt; Achieved score: 34.857 at iteration 807</span></span>
<span><span class="co">#&gt; Achieved score: 32.857 at iteration 827</span></span>
<span><span class="co">#&gt; process    real </span></span>
<span><span class="co">#&gt;   15.7s    8.2s</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  i <span class="op">=</span> <span class="va">bc_burn_in</span><span class="op">$</span><span class="va">trace</span><span class="op">$</span><span class="va">scores</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">step</span>,</span>
<span>  normal <span class="op">=</span> <span class="va">bc_reference</span><span class="op">$</span><span class="va">trace</span><span class="op">$</span><span class="va">scores</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">score_1</span>,</span>
<span>  burnin <span class="op">=</span> <span class="va">bc_burn_in</span><span class="op">$</span><span class="va">trace</span><span class="op">$</span><span class="va">scores</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">score_1</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">i</span>, names_to <span class="op">=</span> <span class="st">"method"</span>, values_to <span class="op">=</span> <span class="st">"score"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">score</span>, col <span class="op">=</span> <span class="va">method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="osat_files/figure-html/unnamed-chunk-16-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="score-demonstration">Score demonstration<a class="anchor" aria-label="anchor" href="#score-demonstration"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bc</span><span class="op">$</span><span class="fu">score</span><span class="op">(</span><span class="va">scoring_f</span><span class="op">)</span></span>
<span><span class="co">#&gt;  score_1 </span></span>
<span><span class="co">#&gt; 360.8571</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/assign_random.html">assign_random</a></span><span class="op">(</span><span class="va">bc</span><span class="op">)</span></span>
<span><span class="co">#&gt; Batch container with 672 locations and 576 samples (assigned).</span></span>
<span><span class="co">#&gt;   Dimensions: plates, chips, rows, columns</span></span>
<span></span>
<span><span class="va">bc</span><span class="op">$</span><span class="fu">get_samples</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 672 × 10</span></span></span>
<span><span class="co">#&gt;    plates chips  rows columns    ID SampleType Race     AgeGrp   dummy_var1</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>      1     1     1       1   563 Control    Hispanic (30,40]      -<span style="color: #BB0000;">1.71</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>      1     1     1       2   488 Control    European (30,40]       0.747</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>      1     1     2       1   215 Case       European (50,60]       0.542</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>      1     1     2       2   268 Case       Hispanic (40,50]      -<span style="color: #BB0000;">0.968</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>      1     1     3       1   165 Case       European (60,100]     -<span style="color: #BB0000;">1.79</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>      1     1     3       2    86 Case       Hispanic (60,100]      1.11 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>      1     1     4       1   264 Case       European (60,100]     -<span style="color: #BB0000;">0.212</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>      1     1     4       2   451 Control    European (30,40]       1.78 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>      1     1     5       1   250 Case       Hispanic (60,100]      0.129</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      1     1     5       2    <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 662 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: dummy_var2 &lt;chr&gt;</span></span></span>
<span><span class="va">bc</span><span class="op">$</span><span class="fu">get_samples</span><span class="op">(</span>remove_empty_locations <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 576 × 10</span></span></span>
<span><span class="co">#&gt;    plates chips  rows columns    ID SampleType Race     AgeGrp   dummy_var1</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>      1     1     1       1   563 Control    Hispanic (30,40]      -<span style="color: #BB0000;">1.71</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>      1     1     1       2   488 Control    European (30,40]       0.747</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>      1     1     2       1   215 Case       European (50,60]       0.542</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>      1     1     2       2   268 Case       Hispanic (40,50]      -<span style="color: #BB0000;">0.968</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>      1     1     3       1   165 Case       European (60,100]     -<span style="color: #BB0000;">1.79</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>      1     1     3       2    86 Case       Hispanic (60,100]      1.11 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>      1     1     4       1   264 Case       European (60,100]     -<span style="color: #BB0000;">0.212</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>      1     1     4       2   451 Control    European (30,40]       1.78 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>      1     1     5       1   250 Case       Hispanic (60,100]      0.129</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      1     1     6       1   191 Case       Hispanic (60,100]      1.12 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 566 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: dummy_var2 &lt;chr&gt;</span></span></span>
<span></span>
<span><span class="va">scoring_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  fc0 <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">samples</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>  fc1 <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">samples</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>  fc2 <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">samples</span><span class="op">)</span> <span class="op">-</span><span class="fl">7</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">bc</span><span class="op">$</span><span class="fu">score</span><span class="op">(</span><span class="va">scoring_f</span><span class="op">)</span></span>
<span><span class="co">#&gt;       fc0       fc1       fc2 </span></span>
<span><span class="co">#&gt;   3.64428 100.78084  -7.00000</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Iakov I. Davydov, Juliane Siebourg-Polster, Guido Steiner, Jitao David Zhang, Balazs Banfai.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
