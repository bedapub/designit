<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shuffling with constraints • designit</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Shuffling with constraints">
<meta property="og:description" content="designit">
<meta property="og:image" content="https://bedapub.github.io/designit/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">designit</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/NCS22_talk.html">designit: a flexible engine to generate experiment layouts</a>
    </li>
    <li>
      <a href="../articles/basic_examples.html">Basic example</a>
    </li>
    <li>
      <a href="../articles/custom_shuffle.html">Using custom shuffle schedule</a>
    </li>
    <li>
      <a href="../articles/invivo_study_design.html">In-vivo study design</a>
    </li>
    <li>
      <a href="../articles/nested_dimensions_examples.html">Nested dimension example</a>
    </li>
    <li>
      <a href="../articles/optimizer_examples.html">Optimizer examples</a>
    </li>
    <li>
      <a href="../articles/osat.html">OSAT and scoring functions</a>
    </li>
    <li>
      <a href="../articles/plate_layouts.html">Plate layouts</a>
    </li>
    <li>
      <a href="../articles/plate_scoring_examples.html">Plate scoring examples</a>
    </li>
    <li>
      <a href="../articles/shuffling_with_constraints.html">Shuffling with constraints</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/BEDApub/designit" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Shuffling with constraints</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/BEDApub/designit/tree/main/vignettes/shuffling_with_constraints.Rmd" class="external-link"><code>vignettes/shuffling_with_constraints.Rmd</code></a></small>
      <div class="hidden name"><code>shuffling_with_constraints.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="purpose-of-the-vignette">Purpose of the vignette<a class="anchor" aria-label="anchor" href="#purpose-of-the-vignette"></a>
</h2>
<p>This example demonstrates that by using customized shuffling
functions, it is possible to restrain the design optimization to only
score sample arrangements that fit the given constraints.</p>
<p>Key idea is that every reshuffling produces a ‘valid’ sample
permutation that is not violating those constraints, even if the
suggested solution may be quite bad. During optimization, we pick the
best design solution from the possible ones by appropriate scoring.</p>
<p>The user is free to implement custom shuffling functions and pass
those to the optimizer. However, some knowledge is required regarding
the internal workings of the optimization and batch container setup.
Therefore the package provides a little generic constructor for
customized shufflings <strong>shuffle_grouped_data</strong> in which
certain types of constraints that relate to grouped samples may be
specified by the passed parameters.</p>
</div>
<div class="section level2">
<h2 id="the-design-problem">The design problem<a class="anchor" aria-label="anchor" href="#the-design-problem"></a>
</h2>
<div class="section level3">
<h3 id="samples-and-treatments">Samples and treatments<a class="anchor" aria-label="anchor" href="#samples-and-treatments"></a>
</h3>
<p>We refer to a simplified version of the <em>in vivo</em> example
which is examined deeper in a dedicated vignette.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"invivo_study_samples"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">invivo_study_samples</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">invivo_study_samples</span>,</span>
<span>  Litter_combine_females <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">Sex</span> <span class="op">==</span> <span class="st">"F"</span>, <span class="st">"female_all"</span>, <span class="va">Litter</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">invivo_study_samples</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    59 obs. of  9 variables:</span></span>
<span><span class="co">#&gt;  $ AnimalID              : chr  "F1" "F2" "F3" "F4" ...</span></span>
<span><span class="co">#&gt;  $ Strain                : chr  "Strain B" "Strain B" "Strain B" "Strain B" ...</span></span>
<span><span class="co">#&gt;  $ Sex                   : chr  "F" "F" "F" "F" ...</span></span>
<span><span class="co">#&gt;  $ BirthDate             : Date, format: "2021-05-24" "2021-03-01" ...</span></span>
<span><span class="co">#&gt;  $ Earmark               : chr  "R" "2L" "2L1R" "L" ...</span></span>
<span><span class="co">#&gt;  $ ArrivalWeight         : num  19.4 26.5 20.8 22.1 22.9 ...</span></span>
<span><span class="co">#&gt;  $ Arrival.weight.Unit   : chr  "g" "g" "g" "g" ...</span></span>
<span><span class="co">#&gt;  $ Litter                : chr  "Litter 1" "Litter 2" "Litter 2" "Litter 2" ...</span></span>
<span><span class="co">#&gt;  $ Litter_combine_females: chr  "female_all" "female_all" "female_all" "female_all" ...</span></span>
<span></span>
<span><span class="va">invivo_study_samples</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Strain</span>, <span class="va">Sex</span>, <span class="va">Litter_combine_females</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div id="gbwhiahlvk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gbwhiahlvk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gbwhiahlvk thead, #gbwhiahlvk tbody, #gbwhiahlvk tfoot, #gbwhiahlvk tr, #gbwhiahlvk td, #gbwhiahlvk th {
  border-style: none;
}

#gbwhiahlvk p {
  margin: 0;
  padding: 0;
}

#gbwhiahlvk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gbwhiahlvk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gbwhiahlvk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gbwhiahlvk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gbwhiahlvk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gbwhiahlvk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gbwhiahlvk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gbwhiahlvk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gbwhiahlvk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gbwhiahlvk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gbwhiahlvk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gbwhiahlvk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gbwhiahlvk .gt_spanner_row {
  border-bottom-style: hidden;
}

#gbwhiahlvk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gbwhiahlvk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gbwhiahlvk .gt_from_md > :first-child {
  margin-top: 0;
}

#gbwhiahlvk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gbwhiahlvk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gbwhiahlvk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gbwhiahlvk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gbwhiahlvk .gt_row_group_first td {
  border-top-width: 2px;
}

#gbwhiahlvk .gt_row_group_first th {
  border-top-width: 2px;
}

#gbwhiahlvk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gbwhiahlvk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gbwhiahlvk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gbwhiahlvk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gbwhiahlvk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gbwhiahlvk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gbwhiahlvk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gbwhiahlvk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gbwhiahlvk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gbwhiahlvk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gbwhiahlvk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gbwhiahlvk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gbwhiahlvk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gbwhiahlvk .gt_left {
  text-align: left;
}

#gbwhiahlvk .gt_center {
  text-align: center;
}

#gbwhiahlvk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gbwhiahlvk .gt_font_normal {
  font-weight: normal;
}

#gbwhiahlvk .gt_font_bold {
  font-weight: bold;
}

#gbwhiahlvk .gt_font_italic {
  font-style: italic;
}

#gbwhiahlvk .gt_super {
  font-size: 65%;
}

#gbwhiahlvk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gbwhiahlvk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gbwhiahlvk .gt_indent_1 {
  text-indent: 5px;
}

#gbwhiahlvk .gt_indent_2 {
  text-indent: 10px;
}

#gbwhiahlvk .gt_indent_3 {
  text-indent: 15px;
}

#gbwhiahlvk .gt_indent_4 {
  text-indent: 20px;
}

#gbwhiahlvk .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Strain">Strain</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Sex">Sex</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Litter_combine_females">Litter_combine_females</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="Strain" class="gt_row gt_left">Strain A</td>
<td headers="Sex" class="gt_row gt_left">F</td>
<td headers="Litter_combine_females" class="gt_row gt_left">female_all</td>
<td headers="n" class="gt_row gt_right">7</td>
</tr>
<tr>
<td headers="Strain" class="gt_row gt_left">Strain A</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Litter_combine_females" class="gt_row gt_left">Litter 10</td>
<td headers="n" class="gt_row gt_right">3</td>
</tr>
<tr>
<td headers="Strain" class="gt_row gt_left">Strain A</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Litter_combine_females" class="gt_row gt_left">Litter 11</td>
<td headers="n" class="gt_row gt_right">4</td>
</tr>
<tr>
<td headers="Strain" class="gt_row gt_left">Strain A</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Litter_combine_females" class="gt_row gt_left">Litter 12</td>
<td headers="n" class="gt_row gt_right">5</td>
</tr>
<tr>
<td headers="Strain" class="gt_row gt_left">Strain A</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Litter_combine_females" class="gt_row gt_left">Litter 13</td>
<td headers="n" class="gt_row gt_right">4</td>
</tr>
<tr>
<td headers="Strain" class="gt_row gt_left">Strain A</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Litter_combine_females" class="gt_row gt_left">Litter 14</td>
<td headers="n" class="gt_row gt_right">6</td>
</tr>
<tr>
<td headers="Strain" class="gt_row gt_left">Strain B</td>
<td headers="Sex" class="gt_row gt_left">F</td>
<td headers="Litter_combine_females" class="gt_row gt_left">female_all</td>
<td headers="n" class="gt_row gt_right">7</td>
</tr>
<tr>
<td headers="Strain" class="gt_row gt_left">Strain B</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Litter_combine_females" class="gt_row gt_left">Litter 1</td>
<td headers="n" class="gt_row gt_right">3</td>
</tr>
<tr>
<td headers="Strain" class="gt_row gt_left">Strain B</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Litter_combine_females" class="gt_row gt_left">Litter 3</td>
<td headers="n" class="gt_row gt_right">5</td>
</tr>
<tr>
<td headers="Strain" class="gt_row gt_left">Strain B</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Litter_combine_females" class="gt_row gt_left">Litter 4</td>
<td headers="n" class="gt_row gt_right">4</td>
</tr>
<tr>
<td headers="Strain" class="gt_row gt_left">Strain B</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Litter_combine_females" class="gt_row gt_left">Litter 5</td>
<td headers="n" class="gt_row gt_right">4</td>
</tr>
<tr>
<td headers="Strain" class="gt_row gt_left">Strain B</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Litter_combine_females" class="gt_row gt_left">Litter 6</td>
<td headers="n" class="gt_row gt_right">4</td>
</tr>
<tr>
<td headers="Strain" class="gt_row gt_left">Strain B</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Litter_combine_females" class="gt_row gt_left">Litter 7</td>
<td headers="n" class="gt_row gt_right">3</td>
</tr>
</tbody>
</table>
</div>
<p>We will use the litter as a factor to form cages in our design.
However, in order to indicate the compatibility of female animals (see
<em>in vivo</em> study vignette), a pseudo-litter
<code>female_all</code> is created here to group all the females
together, marking them as interchangeable for the subgroup (i.e. cage)
allocation.</p>
<p>In the simplified setup we want to assign two treatments to those
animals, balancing for strain and sex as the primary suspected
confounders. The batch container is prepared as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">treatments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Treatment A"</span>, <span class="st">"Treatment B"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">29</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">treatments</span><span class="op">)</span></span>
<span><span class="co">#&gt; treatments</span></span>
<span><span class="co">#&gt; Treatment A Treatment B </span></span>
<span><span class="co">#&gt;          30          29</span></span>
<span></span>
<span><span class="va">bc</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/BatchContainer.html">BatchContainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>locations_table <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Treatment <span class="op">=</span> <span class="va">treatments</span>, Position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">treatments</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assign_in_order.html">assign_in_order</a></span><span class="op">(</span><span class="va">bc</span>, <span class="va">invivo_study_samples</span><span class="op">)</span></span>
<span></span>
<span><span class="va">scoring_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/osat_score_generator.html">osat_score_generator</a></span><span class="op">(</span>batch_vars <span class="op">=</span> <span class="st">"Treatment"</span>, feature_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Strain"</span>, <span class="st">"Sex"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bc</span></span>
<span><span class="co">#&gt; Batch container with 59 locations and 59 samples (assigned).</span></span>
<span><span class="co">#&gt;   Dimensions: Treatment, Position</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="subgroup-related-constraints">Subgroup related constraints<a class="anchor" aria-label="anchor" href="#subgroup-related-constraints"></a>
</h3>
<p>As noted, we have to assign animals to cages in this example. The
cage is thus acting as the grouping factor for the samples (animals) on
which we may want to put further constraints. Concretely:</p>
<ul>
<li>We want to form cages with ideally 3 animals each
(tolerated/preferred range is from 2-5)</li>
<li>Variables Strain, Sex and Treatment must be homogeneous within
cage</li>
<li>Animals of different litters must not be put into the same cage</li>
<li>If at all possible, avoid putting animals with the same ear markings
into one cage</li>
</ul>
<p>We will tackle the usual factor balancing (using the osat score) and
the additional constraints at the same time, combined in one
conceptional framework.</p>
<p>As stated, the main idea is to provide a customized shuffling
function that ensures that only ‘suitable’ design proposals are
generated and passed to the scoring function which will then identify a
good one.</p>
<p>Also keep in mind that what is the cage here could be any subgroup
into which samples have to be partitioned.</p>
</div>
</div>
<div class="section level2">
<h2 id="doing-it-all-in-one-go">Doing it all in one go<a class="anchor" aria-label="anchor" href="#doing-it-all-in-one-go"></a>
</h2>
<p>The wrapper <code>shuffle_grouped_data</code> allows to construct a
shuffling function that satisfies all constraints defined above at the
same time. It can be passed to the optimizer together with other user
defined options such as the scoring or acceptance functions.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bc2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/optimize_design.html">optimize_design</a></span><span class="op">(</span></span>
<span>  <span class="va">bc</span>,</span>
<span>  scoring <span class="op">=</span> <span class="va">scoring_f</span>,</span>
<span>  shuffle_proposal_func <span class="op">=</span> <span class="fu"><a href="../reference/shuffle_grouped_data.html">shuffle_grouped_data</a></span><span class="op">(</span><span class="va">bc</span>,</span>
<span>    allocate_var <span class="op">=</span> <span class="st">"Treatment"</span>,</span>
<span>    keep_together_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Strain"</span>, <span class="st">"Sex"</span><span class="op">)</span>,</span>
<span>    keep_separate_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Earmark"</span><span class="op">)</span>,</span>
<span>    subgroup_var_name <span class="op">=</span> <span class="st">"Cage"</span>,</span>
<span>    n_min <span class="op">=</span> <span class="fl">2</span>, n_ideal <span class="op">=</span> <span class="fl">3</span>, n_max <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    strict <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    report_grouping_as_attribute <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span>,</span>
<span>  max_iter <span class="op">=</span> <span class="fl">600</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formed 4 homogeneous groups using 59 samples.</span></span>
<span><span class="co">#&gt; 22 subgroups needed to satisfy size constraints.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Finding possible ways to allocate variable of interest with 2 levels ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Aborted after 1000010 recursive calls (maxCalls limit).</span></span>
<span><span class="co">#&gt; 176364 allocations found.</span></span>
<span><span class="co">#&gt; Usage of sample attributes --&gt; executing first shuffling call.</span></span>
<span><span class="co">#&gt; Checking variances of 1-dim. score vector.</span></span>
<span><span class="co">#&gt; ... (495.302) - OK</span></span>
<span><span class="co">#&gt; Initial score: 453.202</span></span>
<span><span class="co">#&gt; Adding 4 attributes to samples.</span></span>
<span><span class="co">#&gt; Achieved score: 355.575 at iteration 2</span></span>
<span><span class="co">#&gt; Achieved score: 305.134 at iteration 19</span></span>
<span><span class="co">#&gt; Achieved score: 272.592 at iteration 20</span></span>
<span><span class="co">#&gt; Achieved score: 231.507 at iteration 34</span></span>
<span><span class="co">#&gt; No permutations fulfilling the 'keep_separate' constraints in 1000 iters!</span></span>
<span><span class="co">#&gt; Increasing number of tolerated violations to 1</span></span>
<span><span class="co">#&gt; Achieved score: 181.473 at iteration 52</span></span>
<span><span class="co">#&gt; Achieved score: 143.032 at iteration 116</span></span>
<span><span class="co">#&gt; Achieved score: 122.49 at iteration 123</span></span>
<span><span class="co">#&gt; Achieved score: 105.405 at iteration 165</span></span>
<span><span class="co">#&gt; Achieved score: 104.999 at iteration 356</span></span>
<span><span class="co">#&gt; Achieved score: 79.371 at iteration 384</span></span>
<span><span class="co">#&gt; Achieved score: 52.931 at iteration 525</span></span>
<span><span class="co">#&gt; Achieved score: 44.388 at iteration 546</span></span>
<span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="va">bc2</span><span class="op">$</span><span class="fu">get_samples</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><code>allocate_var</code> is the batch container variable that should
be primarily assigned to individual samples.</p>
<p><code>keep_together_vars</code> is a list of variables that must be
homogeneous within a subgroup (here: cage).</p>
<p><code>keep_separate_vars</code> lists variables which should have
different values within a subgroup (here: cage), if at all possible.
This is a soft constraint and will be relaxed in a stepwise way until
solutions can be found.</p>
<p><code>subgroup_var_name</code> allows to give the generated subgroup
variable a useful name.</p>
<p><code>n_min</code>, <code>n_max</code> and <code>n_ideal</code>
specify the minimal, maximal and ideal group sizes, respectively. It is
often necessary to release the <code>strict</code> criterion to find any
solution at all that satisfies those size criteria.</p>
<p><code>report_grouping_as_attribute</code> allows, if TRUE, to add the
updated group variable into the batch container at each iteration, so
that scoring functions could make use of this variable (here: cage)!</p>
<p>Following the output of the optimizer, we see that a solution was
identified that satisfies all constraints, with the exception of
tolerating one violation of earmark-uniqueness within a cage.</p>
<p>The following cages (homogeneous in strain, sex and treatment) have
been generated in the process:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">design</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Cage</span>, <span class="va">Strain</span>, <span class="va">Sex</span>, <span class="va">Treatment</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div id="qjzhzdfgkb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qjzhzdfgkb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qjzhzdfgkb thead, #qjzhzdfgkb tbody, #qjzhzdfgkb tfoot, #qjzhzdfgkb tr, #qjzhzdfgkb td, #qjzhzdfgkb th {
  border-style: none;
}

#qjzhzdfgkb p {
  margin: 0;
  padding: 0;
}

#qjzhzdfgkb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qjzhzdfgkb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qjzhzdfgkb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qjzhzdfgkb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qjzhzdfgkb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qjzhzdfgkb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qjzhzdfgkb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qjzhzdfgkb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qjzhzdfgkb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qjzhzdfgkb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qjzhzdfgkb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qjzhzdfgkb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qjzhzdfgkb .gt_spanner_row {
  border-bottom-style: hidden;
}

#qjzhzdfgkb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qjzhzdfgkb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qjzhzdfgkb .gt_from_md > :first-child {
  margin-top: 0;
}

#qjzhzdfgkb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qjzhzdfgkb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qjzhzdfgkb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qjzhzdfgkb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qjzhzdfgkb .gt_row_group_first td {
  border-top-width: 2px;
}

#qjzhzdfgkb .gt_row_group_first th {
  border-top-width: 2px;
}

#qjzhzdfgkb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qjzhzdfgkb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qjzhzdfgkb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qjzhzdfgkb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qjzhzdfgkb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qjzhzdfgkb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qjzhzdfgkb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qjzhzdfgkb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qjzhzdfgkb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qjzhzdfgkb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qjzhzdfgkb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qjzhzdfgkb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qjzhzdfgkb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qjzhzdfgkb .gt_left {
  text-align: left;
}

#qjzhzdfgkb .gt_center {
  text-align: center;
}

#qjzhzdfgkb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qjzhzdfgkb .gt_font_normal {
  font-weight: normal;
}

#qjzhzdfgkb .gt_font_bold {
  font-weight: bold;
}

#qjzhzdfgkb .gt_font_italic {
  font-style: italic;
}

#qjzhzdfgkb .gt_super {
  font-size: 65%;
}

#qjzhzdfgkb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qjzhzdfgkb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qjzhzdfgkb .gt_indent_1 {
  text-indent: 5px;
}

#qjzhzdfgkb .gt_indent_2 {
  text-indent: 10px;
}

#qjzhzdfgkb .gt_indent_3 {
  text-indent: 15px;
}

#qjzhzdfgkb .gt_indent_4 {
  text-indent: 20px;
}

#qjzhzdfgkb .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Cage">Cage</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Strain">Strain</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Sex">Sex</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Treatment">Treatment</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="Cage" class="gt_row gt_left">1_1</td>
<td headers="Strain" class="gt_row gt_left">Strain A</td>
<td headers="Sex" class="gt_row gt_left">F</td>
<td headers="Treatment" class="gt_row gt_center">Treatment A</td>
<td headers="n" class="gt_row gt_right">3</td>
</tr>
<tr>
<td headers="Cage" class="gt_row gt_left">1_2</td>
<td headers="Strain" class="gt_row gt_left">Strain A</td>
<td headers="Sex" class="gt_row gt_left">F</td>
<td headers="Treatment" class="gt_row gt_center">Treatment A</td>
<td headers="n" class="gt_row gt_right">2</td>
</tr>
<tr>
<td headers="Cage" class="gt_row gt_left">1_3</td>
<td headers="Strain" class="gt_row gt_left">Strain A</td>
<td headers="Sex" class="gt_row gt_left">F</td>
<td headers="Treatment" class="gt_row gt_center">Treatment A</td>
<td headers="n" class="gt_row gt_right">2</td>
</tr>
<tr>
<td headers="Cage" class="gt_row gt_left">2_1</td>
<td headers="Strain" class="gt_row gt_left">Strain A</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Treatment" class="gt_row gt_center">Treatment A</td>
<td headers="n" class="gt_row gt_right">3</td>
</tr>
<tr>
<td headers="Cage" class="gt_row gt_left">2_2</td>
<td headers="Strain" class="gt_row gt_left">Strain A</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Treatment" class="gt_row gt_center">Treatment A</td>
<td headers="n" class="gt_row gt_right">3</td>
</tr>
<tr>
<td headers="Cage" class="gt_row gt_left">2_3</td>
<td headers="Strain" class="gt_row gt_left">Strain A</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Treatment" class="gt_row gt_center">Treatment A</td>
<td headers="n" class="gt_row gt_right">3</td>
</tr>
<tr>
<td headers="Cage" class="gt_row gt_left">2_4</td>
<td headers="Strain" class="gt_row gt_left">Strain A</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Treatment" class="gt_row gt_center">Treatment A</td>
<td headers="n" class="gt_row gt_right">3</td>
</tr>
<tr>
<td headers="Cage" class="gt_row gt_left">2_5</td>
<td headers="Strain" class="gt_row gt_left">Strain A</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Treatment" class="gt_row gt_center">Treatment B</td>
<td headers="n" class="gt_row gt_right">3</td>
</tr>
<tr>
<td headers="Cage" class="gt_row gt_left">2_6</td>
<td headers="Strain" class="gt_row gt_left">Strain A</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Treatment" class="gt_row gt_center">Treatment B</td>
<td headers="n" class="gt_row gt_right">3</td>
</tr>
<tr>
<td headers="Cage" class="gt_row gt_left">2_7</td>
<td headers="Strain" class="gt_row gt_left">Strain A</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Treatment" class="gt_row gt_center">Treatment B</td>
<td headers="n" class="gt_row gt_right">2</td>
</tr>
<tr>
<td headers="Cage" class="gt_row gt_left">2_8</td>
<td headers="Strain" class="gt_row gt_left">Strain A</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Treatment" class="gt_row gt_center">Treatment B</td>
<td headers="n" class="gt_row gt_right">2</td>
</tr>
<tr>
<td headers="Cage" class="gt_row gt_left">3_1</td>
<td headers="Strain" class="gt_row gt_left">Strain B</td>
<td headers="Sex" class="gt_row gt_left">F</td>
<td headers="Treatment" class="gt_row gt_center">Treatment B</td>
<td headers="n" class="gt_row gt_right">3</td>
</tr>
<tr>
<td headers="Cage" class="gt_row gt_left">3_2</td>
<td headers="Strain" class="gt_row gt_left">Strain B</td>
<td headers="Sex" class="gt_row gt_left">F</td>
<td headers="Treatment" class="gt_row gt_center">Treatment A</td>
<td headers="n" class="gt_row gt_right">2</td>
</tr>
<tr>
<td headers="Cage" class="gt_row gt_left">3_3</td>
<td headers="Strain" class="gt_row gt_left">Strain B</td>
<td headers="Sex" class="gt_row gt_left">F</td>
<td headers="Treatment" class="gt_row gt_center">Treatment B</td>
<td headers="n" class="gt_row gt_right">2</td>
</tr>
<tr>
<td headers="Cage" class="gt_row gt_left">4_1</td>
<td headers="Strain" class="gt_row gt_left">Strain B</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Treatment" class="gt_row gt_center">Treatment A</td>
<td headers="n" class="gt_row gt_right">3</td>
</tr>
<tr>
<td headers="Cage" class="gt_row gt_left">4_2</td>
<td headers="Strain" class="gt_row gt_left">Strain B</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Treatment" class="gt_row gt_center">Treatment A</td>
<td headers="n" class="gt_row gt_right">3</td>
</tr>
<tr>
<td headers="Cage" class="gt_row gt_left">4_3</td>
<td headers="Strain" class="gt_row gt_left">Strain B</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Treatment" class="gt_row gt_center">Treatment A</td>
<td headers="n" class="gt_row gt_right">3</td>
</tr>
<tr>
<td headers="Cage" class="gt_row gt_left">4_4</td>
<td headers="Strain" class="gt_row gt_left">Strain B</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Treatment" class="gt_row gt_center">Treatment B</td>
<td headers="n" class="gt_row gt_right">3</td>
</tr>
<tr>
<td headers="Cage" class="gt_row gt_left">4_5</td>
<td headers="Strain" class="gt_row gt_left">Strain B</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Treatment" class="gt_row gt_center">Treatment B</td>
<td headers="n" class="gt_row gt_right">3</td>
</tr>
<tr>
<td headers="Cage" class="gt_row gt_left">4_6</td>
<td headers="Strain" class="gt_row gt_left">Strain B</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Treatment" class="gt_row gt_center">Treatment B</td>
<td headers="n" class="gt_row gt_right">3</td>
</tr>
<tr>
<td headers="Cage" class="gt_row gt_left">4_7</td>
<td headers="Strain" class="gt_row gt_left">Strain B</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Treatment" class="gt_row gt_center">Treatment B</td>
<td headers="n" class="gt_row gt_right">3</td>
</tr>
<tr>
<td headers="Cage" class="gt_row gt_left">4_8</td>
<td headers="Strain" class="gt_row gt_left">Strain B</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="Treatment" class="gt_row gt_center">Treatment B</td>
<td headers="n" class="gt_row gt_right">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="multiple-step-approach">Multiple step approach<a class="anchor" aria-label="anchor" href="#multiple-step-approach"></a>
</h2>
<p><code>shuffle_grouped_data</code> is a wrapper that consecutively
calls other helper function. As an addendum, let us break the whole
procedure down into parts that show what is happening internally at each
step.</p>
<div class="section level3">
<h3 id="form-homogeneous-subgroups---pools-of-animals-that-could-go-into-one-cage">Form homogeneous subgroups - pools of animals that could go into one
cage<a class="anchor" aria-label="anchor" href="#form-homogeneous-subgroups---pools-of-animals-that-could-go-into-one-cage"></a>
</h3>
<p>We have to divide our animal cohort into subgroups with same strain
and sex, meeting size constraints as stated above. Since 2-5 animals
should go into one cage, we specify <code>n_min</code>and
<code>n_max</code>accordingly. <code>n_ideal</code> would be selected by
default as the mean of those two, but we specify it explicitly here,
too.</p>
<p>The homogeneity of subgroups regarding strain and sex is achieved by
listing those two parameters as <code>keep_together_vars</code>.</p>
<p>Assignment of treatments should be performed as well at some point.
We thus specify Treatment as the <code>allocation variable</code>.</p>
<p>Note that the <code>Treatment</code> variable is technically a batch
container location and not a part of the sample list. This distinction
does not matter at this point. However, all required variables must
exist in the batch container object.</p>
<p>The following call to <code><a href="../reference/form_homogeneous_subgroups.html">form_homogeneous_subgroups()</a></code>
produces an object that holds all relevant information about the
samples, the allocation variable and the sizes of the subgroups that
have to be formed. It is NOT decided, however, which animal will end up
in which subgroup. This will be a matter of optimization later on.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/form_homogeneous_subgroups.html">form_homogeneous_subgroups</a></span><span class="op">(</span></span>
<span>  batch_container <span class="op">=</span> <span class="va">bc</span>, allocate_var <span class="op">=</span> <span class="st">"Treatment"</span>,</span>
<span>  keep_together_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Strain"</span>, <span class="st">"Sex"</span>, <span class="st">"Litter_combine_females"</span><span class="op">)</span>,</span>
<span>  subgroup_var_name <span class="op">=</span> <span class="st">"Cage"</span>,</span>
<span>  n_min <span class="op">=</span> <span class="fl">2</span>, n_ideal <span class="op">=</span> <span class="fl">3</span>, n_max <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formed 13 homogeneous groups using 59 samples.</span></span>
<span><span class="co">#&gt; 18 subgroups needed to satisfy size constraints.</span></span></code></pre></div>
<p>In this example, 18 subgroups have to be formed to meet all
constraints.</p>
<p>It is possible to obtain more information from the returned list
object. Inspection of element <code>Subgroup_Sizes</code> tells us that
13 ‘animal pools’ have to be formed which are homogeneous in the
relevant parameters (here: strain and sex). Each of those groups happens
to be split in subgroups with a size between 2 and 4 animals , which
will later constitute the individual cages.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subg</span><span class="op">$</span><span class="va">Subgroup_Sizes</span></span>
<span><span class="co">#&gt; $`Strain A/F/female_all`</span></span>
<span><span class="co">#&gt; [1] 3 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Strain A/M/Litter 10`</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Strain A/M/Litter 11`</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Strain A/M/Litter 12`</span></span>
<span><span class="co">#&gt; [1] 3 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Strain A/M/Litter 13`</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Strain A/M/Litter 14`</span></span>
<span><span class="co">#&gt; [1] 3 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Strain B/F/female_all`</span></span>
<span><span class="co">#&gt; [1] 3 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Strain B/M/Litter 1`</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Strain B/M/Litter 3`</span></span>
<span><span class="co">#&gt; [1] 3 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Strain B/M/Litter 4`</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Strain B/M/Litter 5`</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Strain B/M/Litter 6`</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Strain B/M/Litter 7`</span></span>
<span><span class="co">#&gt; [1] 3</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="find-all-valid-ways-to-allocate-treatments-to-the-subgroups">Find all valid ways to allocate treatments to the subgroups<a class="anchor" aria-label="anchor" href="#find-all-valid-ways-to-allocate-treatments-to-the-subgroups"></a>
</h3>
<p>Each subgroup of animals receives one specific treatment. Or more
generally: subgroups have to be homogeneous regarding the allocation
variable.</p>
<p>This introduces another type of constraint, since numbers have to add
up to 10 ‘Control’ and 10 ‘Compound’ cases, as given by the
<code>treatments</code> variable. As a next step, we have to find all
possible combinations of subgroups which produce valid options for the
treatment allocation. That’s done with the next call.</p>
<p>This will find a large number of different ways to assign treatments
to subgroups that lead to the correct overall number of treated
animals.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">possible</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compile_possible_subgroup_allocation.html">compile_possible_subgroup_allocation</a></span><span class="op">(</span><span class="va">subg</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Finding possible ways to allocate variable of interest with 2 levels ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Finished with 108296 recursive calls.</span></span>
<span><span class="co">#&gt; 14660 allocations found.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="generate-shuffling-function-for-potential-study-designs">Generate shuffling function for potential study designs<a class="anchor" aria-label="anchor" href="#generate-shuffling-function-for-potential-study-designs"></a>
</h3>
<p>So far we only know the sizes of subgroups (i.e. cages). Thus, in a
last step we have to assign specific animals to the various subgroups.
Ideally each group of ‘equivalent animals’ (in terms of strain and sex)
is split up into more than one subgroup, so there’s many potential ways
to assign animals to those.</p>
<p>To allow optimization as usual, we want to generate a shuffling
function that produces only valid solutions in terms of our constraints,
so that optimization can iterate efficiently over this solution space.
The function can be generated by calling
<em>shuffle_with_subgroup_formation()</em> with the previously created
subgrouping object and the list of possible treatment allocations.</p>
<p>Every call to this shuffling function will return a permutation index
(of the original samples) that constitutes a valid solution to be
scored.</p>
<p>The permutation function actually also constructs a ‘Cage’ variable
(see parameter <code>subgroup_var_name</code> in the call to
<em>form_homogeneous_subgroups()</em>). To make this parameter available
and join it to the samples in the batch container, use flag
<code>report_grouping_as_attribute</code> in the construction of the
permutation function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shuffle_proposal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/shuffle_with_subgroup_formation.html">shuffle_with_subgroup_formation</a></span><span class="op">(</span><span class="va">subg</span>, <span class="va">possible</span>, report_grouping_as_attribute <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">shuffle_proposal</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $location_assignment</span></span>
<span><span class="co">#&gt;  [1]  8  9 12 10 11 13 14 38 39 40 41 42 43 44 45 47 48 46 49 50 51 52 53 54 56</span></span>
<span><span class="co">#&gt; [26] 59  1  4  5  7 55 57 58  2  3  6 35 36 37 19 26 27 20 21 15 16 17 18 22 23</span></span>
<span><span class="co">#&gt; [51] 24 25 28 29 30 31 32 33 34</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $samples_attr</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 59 × 4</span></span></span>
<span><span class="co">#&gt;    alloc_var_level group subgroup Cage </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Treatment A         7        2 7_2  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Treatment B         7        1 7_1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Treatment B         7        1 7_1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Treatment A         7        2 7_2  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Treatment A         7        2 7_2  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Treatment B         7        1 7_1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Treatment A         7        2 7_2  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Treatment A         1        1 1_1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Treatment A         1        1 1_1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Treatment A         1        2 1_2  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 49 more rows</span></span></span></code></pre></div>
<p>Calling the shuffle proposal function repeatedly produces a valid
(constraint-aware) sample arrangement each time, with the grouping
variable (here: Cage) reported alongside. (The optimizer will merge the
‘Cage’ variable into the batch container after each iteration, so that
it can be used for scoring as if it would have been in the container
from the beginning!)</p>
</div>
<div class="section level3">
<h3 id="use-shuffling-function-for-optimizing-design">Use shuffling function for optimizing design<a class="anchor" aria-label="anchor" href="#use-shuffling-function-for-optimizing-design"></a>
</h3>
<p>We can finally use the customized shuffling function in the
optimization.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bc3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/optimize_design.html">optimize_design</a></span><span class="op">(</span></span>
<span>  <span class="va">bc</span>,</span>
<span>  scoring <span class="op">=</span> <span class="va">scoring_f</span>,</span>
<span>  shuffle_proposal_func <span class="op">=</span> <span class="va">shuffle_proposal</span>,</span>
<span>  max_iter <span class="op">=</span> <span class="fl">300</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Usage of sample attributes --&gt; executing first shuffling call.</span></span>
<span><span class="co">#&gt; Checking variances of 1-dim. score vector.</span></span>
<span><span class="co">#&gt; ... (416.772) - OK</span></span>
<span><span class="co">#&gt; Initial score: 289.541</span></span>
<span><span class="co">#&gt; Adding 4 attributes to samples.</span></span>
<span><span class="co">#&gt; Achieved score: 189.066 at iteration 9</span></span>
<span><span class="co">#&gt; Achieved score: 139.439 at iteration 15</span></span>
<span><span class="co">#&gt; Achieved score: 105.405 at iteration 34</span></span>
<span><span class="co">#&gt; Achieved score: 52.931 at iteration 55</span></span>
<span><span class="co">#&gt; Achieved score: 51.304 at iteration 70</span></span>
<span><span class="co">#&gt; Achieved score: 32.863 at iteration 206</span></span>
<span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="va">bc3</span><span class="op">$</span><span class="fu">get_samples</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Obeying all constraints does not lead to a very balanced sample allocation:</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">design</span>, <span class="va">Treatment</span>, <span class="va">Strain</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div id="xibermqbnn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xibermqbnn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xibermqbnn thead, #xibermqbnn tbody, #xibermqbnn tfoot, #xibermqbnn tr, #xibermqbnn td, #xibermqbnn th {
  border-style: none;
}

#xibermqbnn p {
  margin: 0;
  padding: 0;
}

#xibermqbnn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xibermqbnn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xibermqbnn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xibermqbnn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xibermqbnn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xibermqbnn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xibermqbnn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xibermqbnn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xibermqbnn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xibermqbnn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xibermqbnn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xibermqbnn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xibermqbnn .gt_spanner_row {
  border-bottom-style: hidden;
}

#xibermqbnn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xibermqbnn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xibermqbnn .gt_from_md > :first-child {
  margin-top: 0;
}

#xibermqbnn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xibermqbnn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xibermqbnn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xibermqbnn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xibermqbnn .gt_row_group_first td {
  border-top-width: 2px;
}

#xibermqbnn .gt_row_group_first th {
  border-top-width: 2px;
}

#xibermqbnn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xibermqbnn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xibermqbnn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xibermqbnn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xibermqbnn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xibermqbnn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xibermqbnn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xibermqbnn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xibermqbnn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xibermqbnn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xibermqbnn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xibermqbnn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xibermqbnn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xibermqbnn .gt_left {
  text-align: left;
}

#xibermqbnn .gt_center {
  text-align: center;
}

#xibermqbnn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xibermqbnn .gt_font_normal {
  font-weight: normal;
}

#xibermqbnn .gt_font_bold {
  font-weight: bold;
}

#xibermqbnn .gt_font_italic {
  font-style: italic;
}

#xibermqbnn .gt_super {
  font-size: 65%;
}

#xibermqbnn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xibermqbnn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xibermqbnn .gt_indent_1 {
  text-indent: 5px;
}

#xibermqbnn .gt_indent_2 {
  text-indent: 10px;
}

#xibermqbnn .gt_indent_3 {
  text-indent: 15px;
}

#xibermqbnn .gt_indent_4 {
  text-indent: 20px;
}

#xibermqbnn .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Treatment">Treatment</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Strain">Strain</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="Treatment" class="gt_row gt_center">Treatment A</td>
<td headers="Strain" class="gt_row gt_left">Strain A</td>
<td headers="n" class="gt_row gt_right">17</td>
</tr>
<tr>
<td headers="Treatment" class="gt_row gt_center">Treatment A</td>
<td headers="Strain" class="gt_row gt_left">Strain B</td>
<td headers="n" class="gt_row gt_right">13</td>
</tr>
<tr>
<td headers="Treatment" class="gt_row gt_center">Treatment B</td>
<td headers="Strain" class="gt_row gt_left">Strain A</td>
<td headers="n" class="gt_row gt_right">12</td>
</tr>
<tr>
<td headers="Treatment" class="gt_row gt_center">Treatment B</td>
<td headers="Strain" class="gt_row gt_left">Strain B</td>
<td headers="n" class="gt_row gt_right">17</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">design</span>, <span class="va">Treatment</span>, <span class="va">Sex</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div id="scwweggkea" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#scwweggkea table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#scwweggkea thead, #scwweggkea tbody, #scwweggkea tfoot, #scwweggkea tr, #scwweggkea td, #scwweggkea th {
  border-style: none;
}

#scwweggkea p {
  margin: 0;
  padding: 0;
}

#scwweggkea .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#scwweggkea .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#scwweggkea .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#scwweggkea .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#scwweggkea .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#scwweggkea .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#scwweggkea .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#scwweggkea .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#scwweggkea .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#scwweggkea .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#scwweggkea .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#scwweggkea .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#scwweggkea .gt_spanner_row {
  border-bottom-style: hidden;
}

#scwweggkea .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#scwweggkea .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#scwweggkea .gt_from_md > :first-child {
  margin-top: 0;
}

#scwweggkea .gt_from_md > :last-child {
  margin-bottom: 0;
}

#scwweggkea .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#scwweggkea .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#scwweggkea .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#scwweggkea .gt_row_group_first td {
  border-top-width: 2px;
}

#scwweggkea .gt_row_group_first th {
  border-top-width: 2px;
}

#scwweggkea .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#scwweggkea .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#scwweggkea .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#scwweggkea .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#scwweggkea .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#scwweggkea .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#scwweggkea .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#scwweggkea .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#scwweggkea .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#scwweggkea .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#scwweggkea .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#scwweggkea .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#scwweggkea .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#scwweggkea .gt_left {
  text-align: left;
}

#scwweggkea .gt_center {
  text-align: center;
}

#scwweggkea .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#scwweggkea .gt_font_normal {
  font-weight: normal;
}

#scwweggkea .gt_font_bold {
  font-weight: bold;
}

#scwweggkea .gt_font_italic {
  font-style: italic;
}

#scwweggkea .gt_super {
  font-size: 65%;
}

#scwweggkea .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#scwweggkea .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#scwweggkea .gt_indent_1 {
  text-indent: 5px;
}

#scwweggkea .gt_indent_2 {
  text-indent: 10px;
}

#scwweggkea .gt_indent_3 {
  text-indent: 15px;
}

#scwweggkea .gt_indent_4 {
  text-indent: 20px;
}

#scwweggkea .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Treatment">Treatment</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Sex">Sex</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="Treatment" class="gt_row gt_center">Treatment A</td>
<td headers="Sex" class="gt_row gt_left">F</td>
<td headers="n" class="gt_row gt_right">10</td>
</tr>
<tr>
<td headers="Treatment" class="gt_row gt_center">Treatment A</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="n" class="gt_row gt_right">20</td>
</tr>
<tr>
<td headers="Treatment" class="gt_row gt_center">Treatment B</td>
<td headers="Sex" class="gt_row gt_left">F</td>
<td headers="n" class="gt_row gt_right">4</td>
</tr>
<tr>
<td headers="Treatment" class="gt_row gt_center">Treatment B</td>
<td headers="Sex" class="gt_row gt_left">M</td>
<td headers="n" class="gt_row gt_right">25</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Iakov I. Davydov, Juliane Siebourg-Polster, Guido Steiner, Balazs Banfai.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
